<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Pedro J. Aphalo (SenPEP)">
<meta name="dcterms.date" content="2024-06-11">
<meta name="keywords" content="datalogger, data processing, published data">
<title>FBES/OEB/SenPEP Weather Station - Data acquired and computed - Version 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="site_libs/quarto-diagram/mermaid.min.js"></script><script src="site_libs/quarto-diagram/mermaid-init.js"></script><link href="site_libs/quarto-diagram/mermaid.css" rel="stylesheet">
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="styles.css">
</head>
<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">FBES/OEB/SenPEP Weather Station</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-methods" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Methods</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-methods">
<li>
    <a class="dropdown-item" href="./station-equipment.html">
 <span class="dropdown-text">Equipment</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./station-data-description.html">
 <span class="dropdown-text">Computations</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item">
    <a class="nav-link" href="https://osf.io/e4vau/"> 
<span class="menu-text">Data access</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-about" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">About</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-about">
<li>
    <a class="dropdown-item" href="./data-users.html">
 <span class="dropdown-text">Publications and Users</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./about.html">
 <span class="dropdown-text">About</span></a>
  </li>  
    </ul>
</li>
</ul>
</div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#what-makes-data-from-this-weather-station-different" id="toc-what-makes-data-from-this-weather-station-different" class="nav-link active" data-scroll-target="#what-makes-data-from-this-weather-station-different"><span class="header-section-number">1</span> What makes data from this weather station different?</a></li>
  <li><a href="#data-availability" id="toc-data-availability" class="nav-link" data-scroll-target="#data-availability"><span class="header-section-number">2</span> Data availability</a></li>
  <li><a href="#limitations-of-the-data" id="toc-limitations-of-the-data" class="nav-link" data-scroll-target="#limitations-of-the-data"><span class="header-section-number">3</span> Limitations of the data</a></li>
  <li><a href="#the-data-flow" id="toc-the-data-flow" class="nav-link" data-scroll-target="#the-data-flow"><span class="header-section-number">4</span> The data flow</a></li>
  <li>
<a href="#logged-acquired-and-summary-values" id="toc-logged-acquired-and-summary-values" class="nav-link" data-scroll-target="#logged-acquired-and-summary-values"><span class="header-section-number">5</span> Logged acquired and summary values</a>
  <ul class="collapse">
<li><a href="#data-acquisition" id="toc-data-acquisition" class="nav-link" data-scroll-target="#data-acquisition"><span class="header-section-number">5.1</span> Data acquisition</a></li>
  <li><a href="#quantities-logged-once-per-half-second" id="toc-quantities-logged-once-per-half-second" class="nav-link" data-scroll-target="#quantities-logged-once-per-half-second"><span class="header-section-number">5.2</span> Quantities logged once per half second</a></li>
  <li><a href="#quantities-logged-once-per-minute" id="toc-quantities-logged-once-per-minute" class="nav-link" data-scroll-target="#quantities-logged-once-per-minute"><span class="header-section-number">5.3</span> Quantities logged once per minute</a></li>
  <li><a href="#quantities-logged-once-per-hour" id="toc-quantities-logged-once-per-hour" class="nav-link" data-scroll-target="#quantities-logged-once-per-hour"><span class="header-section-number">5.4</span> Quantities logged once per hour</a></li>
  </ul>
</li>
  <li><a href="#data-processing-in-r" id="toc-data-processing-in-r" class="nav-link" data-scroll-target="#data-processing-in-r"><span class="header-section-number">6</span> Data processing in R</a></li>
  <li><a href="#information-about-the-published-data" id="toc-information-about-the-published-data" class="nav-link" data-scroll-target="#information-about-the-published-data"><span class="header-section-number">7</span> Information about the published data</a></li>
  <li>
<a href="#example-plots" id="toc-example-plots" class="nav-link" data-scroll-target="#example-plots"><span class="header-section-number">8</span> Example plots</a>
  <ul class="collapse">
<li><a href="#par-photon-irradiance" id="toc-par-photon-irradiance" class="nav-link" data-scroll-target="#par-photon-irradiance"><span class="header-section-number">8.1</span> PAR photon irradiance</a></li>
  <li><a href="#soil-temperature-profile" id="toc-soil-temperature-profile" class="nav-link" data-scroll-target="#soil-temperature-profile"><span class="header-section-number">8.2</span> Soil temperature profile</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Data acquired and computed - Version 2</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">Quantities published and their origin</p>
  <div class="quarto-categories">
    <div class="quarto-category">Methods</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Pedro J. Aphalo (SenPEP) </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">2024-06-11</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">2024-06-11</p>
    </div>
  </div>
    
  </div>
  
<div>
  <div class="abstract">
    <div class="block-title">Abstract</div>
    <p>This page describes the data available from the weather station at the Viikki campus of the University of Helsinki, at Helsinki, Finland, since May 2024.</p>
  </div>
</div>

<div>
  <div class="keywords">
    <div class="block-title">Keywords</div>
    <p>datalogger, data processing, published data</p>
  </div>
</div>

</header><div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/ggridges/">ggridges</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.r4photobiology.info/ggpmisc/">ggpmisc</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="what-makes-data-from-this-weather-station-different" class="level1" data-number="1"><h1 data-number="1">
<span class="header-section-number">1</span> What makes data from this weather station different?</h1>
<ul>
<li><p>Time interval for acquisition of light measurements (From 2024-05-14): 50 ms.</p></li>
<li><p>Time interval for logging of summaries (From 2024-05-14): 50 ms, 500 ms, 1 min, 1 h.</p></li>
<li><p>Solar radiation measurement: seven types of broadband sensors, to increase to eight.</p></li>
<li><p>Soil measurements as a depth profile.</p></li>
<li><p>Data summaries provided as a free service for research at the experimental field of the Viikki campus.</p></li>
<li><p>Data for state-of-the-art research on the spectrum of sunlight and its fast variation.</p></li>
<li><p>Open access to these data, deposited under a citable DOI.</p></li>
</ul></section><section id="data-availability" class="level1" data-number="2"><h1 data-number="2">
<span class="header-section-number">2</span> Data availability</h1>
<p><a href="https://osf.io/e4vau/">Open access through Open Science Foundation</a> under <a href="https:doi.org/10.17605/OSF.IO/E4VAU">DOI 10.17605/OSF.IO/E4VAU</a>.</p>
<p>To be cited, after adding date when the site was visited to download the data, as:</p>
<p>Aphalo, Pedro J. 2024. <em>High Frequency Weather Data for Viikki, Helsinki, Finland.</em> OSF. doi:10.17605/OSF.IO/E4VAU.</p>
</section><section id="limitations-of-the-data" class="level1" data-number="3"><h1 data-number="3">
<span class="header-section-number">3</span> Limitations of the data</h1>
<p>Radiation data in winter months are parply unreliable as the sensors lack a blower to keep the snow away. Some of the radiation sensors have heating but this does not help much with sticky snow. Precipitation as snow or sleet is not detected by the weather transmitter, and also wind measurements can be potentially affected by snow and ice accumulation even with heating. Other variables can be trusted year-round. The intention of this station was initially to <em>take readings during the growing season</em>. The data in the files include winter values for all variables, including those which are expected not reliable on many days between mid November and late March, and a few days in April.</p>
<p>DATA ARE PROVIDED AS IS, WITH NO GUARANTEE, even if the station is managed as carefully with the limited resources available.</p>
</section><section id="the-data-flow" class="level1" data-number="4"><h1 data-number="4">
<span class="header-section-number">4</span> The data flow</h1>
<p>The acquisition and summarizing of data requires multiples steps, some performed on board the datalogger and some in a computer <a href="#fig-data-flow-chart" class="quarto-xref">Figure&nbsp;1</a>. The program in the logger is written in CRBasic, data are downloaded through a USB connection to a laptop computer in the field, using the program <a href="https://www.campbellsci.com/pc400">PC400</a>. Later computations are done with R scripts that make use of packages from the <a href="https://www.r4photobiology.info/pages/r4p-introduction.html">R for Photobiology Suite</a> (Aphalo2025)</p>
<p>The scripts and logger program had to be rewritten to make it possible faster measurements. Fewer computations are carried out on the logger and more are done off-line. Data are logged in general at the fastest rate possible or needed and value at slower rates are computed off-line. At the moment, only new data are being processed with the new scripts. The operations are the same but with different acquisition frequency slight differences are possible between version 1 and version 2 data sets.</p>
<p>In version 2 a master script calls the other scripts. The intention is to publish also daily summaries, which were not distributed until now.</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div id="fig-data-flow-chart" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-data-flow-chart-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div>
<pre class="mermaid mermaid-js" data-label="fig-data-flow-chart">flowchart TD
    A((Datalogger:\nData acquisition)) -.-&gt; B
    B[Datalogger:\n Computation of summaries\n and data storage] --&gt;|Download data| C
    C[Computer with PC400:\n Data download from logger] --&gt;|Import data| D
    D[Computer with R:\n Read most recent raw data file\n and validate data] -.-&gt; DD
    DD[Computer with R:\n Save data to .Rda file\n and validate data] --&gt;|Read data| E
    E[Computer with R:\n Read all data from .Rda files] -.-&gt; EE
    EE[Computer with R:\n Apply sensor calibrations based on dates] -.-&gt; F
    F[Computer with R:\n Merge data into a single time series] -.-&gt; G
    G[Computer with R:\n compute derived quantities] -.-&gt; H
    H[Computer with R:\n prepare metadata and add it to R objects] -.-&gt; I
    I[Computer with R:\n save to .Rda and .CSV files] --&gt;|Upload| J((OSF repository:\n publish on line))
</pre>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-data-flow-chart-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Simplified flowchart of the steps from data acquisition to publication of the data.
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Over the eight years during which the station has been operational, there have been changes in the installed sensors (described under <a href="station.equipment.qmd">Equipment used and site description</a>), and in the program run in the datalogger to acquire the data. Most of the earlier changes to the program were related to the installation of new sensors. However, recent changes to increase the data acquisition frequency meant that the processing capacity and available memory in the logger became limiting. To solve this problem we had to off-load some summary computations to processing off-line.</p>
<p>This change does not affect the continuity of the published time series data, as the two approaches are numerically equivalent.</p>
<p>The change in data acquisition frequency from once every 5 s to once every 0.5 s on 2024-05-14, could in principle decrease the variability of the 1 min summaries. However, the averaging period used for data acquisition was decreased at the same time as the frequency was increased. Means in the 1 min and 1 h time series are, thus, unlikely to be affected significantly. Minima and maxima, and standard deviations could, potentially be slightly affected.</p>
<p>Soil data are acquired once every 12 min, and 1 h means of 5 values logged. The values returned by the Vaisala WXT520 weather transmitter are acquired once every 10 s for the WXT536. The averaging period in the WXT536 is also 10 s, 1 min and 1 h averages should not be affected by this change. Minima and maxima, and standard deviations could, potentially be slightly affected.</p>
<p>Data logging every 500 ms from data acquired every 50 ms is worthwhile only if the variables being measured change this fast and the sensors have a suitably short response time constant. The broad band light and UV sensors in use have a time constant of 150 ms or better. The Apogee PAR sensor with analogue output that we use has according to specifications a response time constant &lt; 1 ms, so data from this sensor are additionally logged during one 5-min burst per hour at 50 ms.</p>
<p>One consequence of these changes is the increased amount of data: for the 0.5 s time step data raw-data files are approximately 1 GB per month. This makes downloading data from the datalogger rather tedious.</p>
</div>
</div>
</section><section id="logged-acquired-and-summary-values" class="level1" data-number="5"><h1 data-number="5">
<span class="header-section-number">5</span> Logged acquired and summary values</h1>
<p>In this section I list the variables that are stored in the logger’s memory at different time intervals, plus the time and date-related variables that are computed and adjusted to UTC when the data are imported into R. The tables describe the variables as acquired and logged starting on 2024-04-15.</p>
<section id="data-acquisition" class="level2" data-number="5.1"><h2 data-number="5.1" class="anchored" data-anchor-id="data-acquisition">
<span class="header-section-number">5.1</span> Data acquisition</h2>
<p>Fast measurements from analogue sensors are given priority over the communication with sensors with digital serial interfaces using the SDI12 protocol. The SDI12 protocol is used by the soil profile sensors and the weather transmitter. Data from analogue sensors is acquired almost synchronously, but not perfectly, as autoranging is used.</p>
</section><section id="quantities-logged-once-per-half-second" class="level2" data-number="5.2"><h2 data-number="5.2" class="anchored" data-anchor-id="quantities-logged-once-per-half-second">
<span class="header-section-number">5.2</span> Quantities logged once per half second</h2>
<p>Logging of data once per 1 s tarted on 2024-04-15, thus the data listed in <a href="#tbl-logged-second" class="quarto-xref">Table&nbsp;1</a> are not available before this date at this frequency. They are nonetheless available as 1 min averages computed from data acquired once every 5 s.</p>
<div id="tbl-logged-second" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-logged-second-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Data logged once every 500 ms as means of 10 acquired values. Column ‘summary’ shows how the data are summarised by the datalogger before being stored, <em>sample</em> indicating that the most recently acquired value is stored. The units are those obtained after off-line application of calibration factors.
</figcaption><div aria-describedby="tbl-logged-second-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead><tr class="header">
<th style="text-align: left;">Quantity</th>
<th style="text-align: left;">Summary</th>
<th style="text-align: left;">Units</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">“TIMESTAMP”</td>
<td style="text-align: left;">mean of 10</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">“PAR_Den”</td>
<td style="text-align: left;">mean of 10</td>
<td style="text-align: left;">µmol/s/m²</td>
</tr>
<tr class="odd">
<td style="text-align: left;">“PAR_BF_tot”</td>
<td style="text-align: left;">mean of 10</td>
<td style="text-align: left;">µmol/s/m²</td>
</tr>
<tr class="even">
<td style="text-align: left;">“PAR_BF_diff”</td>
<td style="text-align: left;">mean of 10</td>
<td style="text-align: left;">µmol/s/m²</td>
</tr>
<tr class="odd">
<td style="text-align: left;">“Red_Den_cal”</td>
<td style="text-align: left;">mean of 10</td>
<td style="text-align: left;">µmol/s/m²</td>
</tr>
<tr class="even">
<td style="text-align: left;">“Far_red_Den_cal”</td>
<td style="text-align: left;">mean of 10</td>
<td style="text-align: left;">µmol/s/m²</td>
</tr>
<tr class="odd">
<td style="text-align: left;">“Blue_Den”</td>
<td style="text-align: left;">mean of 10</td>
<td style="text-align: left;">µmol/s/m²</td>
</tr>
<tr class="even">
<td style="text-align: left;">“UVA_Den”</td>
<td style="text-align: left;">mean of 10</td>
<td style="text-align: left;">µmol/s/m²</td>
</tr>
<tr class="odd">
<td style="text-align: left;">“UVB_Den”</td>
<td style="text-align: left;">mean of 10</td>
<td style="text-align: left;">µmol/s/m²</td>
</tr>
<tr class="even">
<td style="text-align: left;">“SurfTemp_grnd”</td>
<td style="text-align: left;">mean of 10</td>
<td style="text-align: left;">C</td>
</tr>
<tr class="odd">
<td style="text-align: left;">“SurfTemp_veg”</td>
<td style="text-align: left;">mean of 10</td>
<td style="text-align: left;">C</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</section><section id="quantities-logged-once-per-minute" class="level2" data-number="5.3"><h2 data-number="5.3" class="anchored" data-anchor-id="quantities-logged-once-per-minute">
<span class="header-section-number">5.3</span> Quantities logged once per minute</h2>
<p>The values currently logged are listed in <a href="#tbl-logged-minute" class="quarto-xref">Table&nbsp;2</a>. The quantities logged once per minute are means of multiple data values acquired by the data logger from the sensors. Until 2024-04-15 the data acquired values acquired once every 5 s, from which the summaries listed in <a href="#tbl-logged-minute" class="quarto-xref">Table&nbsp;2</a> are derived were not logged. Starting from 2024-04-15, data are being acquired more frequently, once every 1 s, and thus the number of values used to compute 1 min means and other summaries has increased from 12 to 60. In the case of the weather variables acquired with the WXT weather transmitters, the data acquired by the logger are summaries computed on-board of these “intelligent sensors”.</p>
<div id="tbl-logged-minute" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-logged-minute-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Data logged once per minute available before computation of derived quantities. Column ‘summary’ shows how the data are summarised by the datalogger before being stored. The units are those obtained after off-line application of calibration factors.
</figcaption><div aria-describedby="tbl-logged-minute-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead><tr class="header">
<th style="text-align: left;">Quantity</th>
<th style="text-align: left;">Summary</th>
<th style="text-align: left;">Units</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">“TIMESTAMP”</td>
<td style="text-align: left;">sample</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">“WindSpd_S_WVT”</td>
<td style="text-align: left;">mean of 6 values</td>
<td style="text-align: left;">m/s</td>
</tr>
<tr class="odd">
<td style="text-align: left;">“WindDir_D1_WVT”</td>
<td style="text-align: left;">mean of 6 values</td>
<td style="text-align: left;">Deg</td>
</tr>
<tr class="even">
<td style="text-align: left;">“WindDir_SD1_WVT”</td>
<td style="text-align: left;">mean of 6 values</td>
<td style="text-align: left;">Deg</td>
</tr>
<tr class="odd">
<td style="text-align: left;">“AirTemp_Avg”</td>
<td style="text-align: left;">mean of 6 values</td>
<td style="text-align: left;">C</td>
</tr>
<tr class="even">
<td style="text-align: left;">“AirTemp_Min”</td>
<td style="text-align: left;">min of 6 values</td>
<td style="text-align: left;">C</td>
</tr>
<tr class="odd">
<td style="text-align: left;">“AirTemp_Max”</td>
<td style="text-align: left;">max of 6 values</td>
<td style="text-align: left;">C</td>
</tr>
<tr class="even">
<td style="text-align: left;">“RelHumidity”</td>
<td style="text-align: left;">mean of 6 values</td>
<td style="text-align: left;">%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">“AirDewPoint”</td>
<td style="text-align: left;">mean of 6 values</td>
<td style="text-align: left;">C</td>
</tr>
<tr class="even">
<td style="text-align: left;">“AirPressure”</td>
<td style="text-align: left;">mean of 6 values</td>
<td style="text-align: left;">hPa</td>
</tr>
<tr class="odd">
<td style="text-align: left;">“Ramount_Tot”</td>
<td style="text-align: left;">sum</td>
<td style="text-align: left;">mm</td>
</tr>
<tr class="even">
<td style="text-align: left;">“Hamount_Tot”</td>
<td style="text-align: left;">sum</td>
<td style="text-align: left;">hits/cm2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">“T107_C_Avg(1-4)”</td>
<td style="text-align: left;">mean of 12/60 values</td>
<td style="text-align: left;">C</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</section><section id="quantities-logged-once-per-hour" class="level2" data-number="5.4"><h2 data-number="5.4" class="anchored" data-anchor-id="quantities-logged-once-per-hour">
<span class="header-section-number">5.4</span> Quantities logged once per hour</h2>
<p>The values currently logged are listed in <a href="#tbl-logged-hour" class="quarto-xref">Table&nbsp;3</a>, respectively. These values are directly computed from the acquired data, not from 1 min means.</p>
<div id="tbl-logged-hour" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-logged-hour-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: Data logged once per hour available before computation of derived quantities. Column ‘summary’ shows how the data are summarised by the datalogger before being stored. When the number of values is indicated as 720/3600, 720 is for data acquired before 2024-04-15 and 3600 for more recent data. The units are those obtained after off-line application of calibration factors. As for data logged at 1 min intervals, the TIMESTAMP is converted to UTC time. Sun angles are not computed.
</figcaption><div aria-describedby="tbl-logged-hour-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 32%">
<col style="width: 52%">
<col style="width: 14%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Quantity</th>
<th style="text-align: left;">Summary</th>
<th style="text-align: left;">Units</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">“TIMESTAMP”</td>
<td style="text-align: left;">sample</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">“VWC_[1-3]_Avg”</td>
<td style="text-align: left;">mean of 5 values</td>
<td style="text-align: left;">m3/m-3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">“EC_[1-3]_Avg”</td>
<td style="text-align: left;">mean of 5 values</td>
<td style="text-align: left;">dS/m</td>
</tr>
<tr class="even">
<td style="text-align: left;">“T_[1-3]_Avg”</td>
<td style="text-align: left;">mean of 5 values</td>
<td style="text-align: left;">C</td>
</tr>
<tr class="odd">
<td style="text-align: left;">“VWC_5cm_[1-3]”</td>
<td style="text-align: left;">mean of 5 values</td>
<td style="text-align: left;">m3/m-3</td>
</tr>
<tr class="even">
<td style="text-align: left;">“Ka_5cm_[1-3]”</td>
<td style="text-align: left;">mean of 5 values</td>
<td style="text-align: left;">1..80</td>
</tr>
<tr class="odd">
<td style="text-align: left;">“T_5cm_[1-3]”</td>
<td style="text-align: left;">mean of 5 values</td>
<td style="text-align: left;">C</td>
</tr>
<tr class="even">
<td style="text-align: left;">“BulkEC_5cm_[1-3]”</td>
<td style="text-align: left;">mean of 5 values</td>
<td style="text-align: left;">dS/m</td>
</tr>
<tr class="odd">
<td style="text-align: left;">“VWC_10cm_[1-3]”</td>
<td style="text-align: left;">mean of 5 values</td>
<td style="text-align: left;">m3/m-3</td>
</tr>
<tr class="even">
<td style="text-align: left;">“Ka_10cm_[1-3]”</td>
<td style="text-align: left;">mean of 5 values</td>
<td style="text-align: left;">1..80</td>
</tr>
<tr class="odd">
<td style="text-align: left;">“T_10cm_[1-3]”</td>
<td style="text-align: left;">mean of 5 values</td>
<td style="text-align: left;">C</td>
</tr>
<tr class="even">
<td style="text-align: left;">“BulkEC_10cm_[1-3]”</td>
<td style="text-align: left;">mean of 5 values</td>
<td style="text-align: left;">dS/m</td>
</tr>
<tr class="odd">
<td style="text-align: left;">“VWC_20cm_[1-3]”</td>
<td style="text-align: left;">mean of 5 values</td>
<td style="text-align: left;">m3/m-3</td>
</tr>
<tr class="even">
<td style="text-align: left;">“Ka_20cm_[1-3]”</td>
<td style="text-align: left;">mean of 5 values</td>
<td style="text-align: left;">1..80</td>
</tr>
<tr class="odd">
<td style="text-align: left;">“T_20cm_[1-3]”</td>
<td style="text-align: left;">mean of 5 values</td>
<td style="text-align: left;">C</td>
</tr>
<tr class="even">
<td style="text-align: left;">“BulkEC_20cm_[1-3]”</td>
<td style="text-align: left;">mean of 5 values</td>
<td style="text-align: left;">dS/m</td>
</tr>
<tr class="odd">
<td style="text-align: left;">“VWC_30cm_[1-3]”</td>
<td style="text-align: left;">mean of 5 values</td>
<td style="text-align: left;">m3/m-3</td>
</tr>
<tr class="even">
<td style="text-align: left;">“Ka_30cm_[1-3]”</td>
<td style="text-align: left;">mean of 5 values</td>
<td style="text-align: left;">1..80</td>
</tr>
<tr class="odd">
<td style="text-align: left;">“T_30cm_[1-3]”</td>
<td style="text-align: left;">mean of 5 values</td>
<td style="text-align: left;">C</td>
</tr>
<tr class="even">
<td style="text-align: left;">“BulkEC_30cm_[1-3]”</td>
<td style="text-align: left;">mean of 5 values</td>
<td style="text-align: left;">dS/m</td>
</tr>
<tr class="odd">
<td style="text-align: left;">“VWC_40cm_[1-3]”</td>
<td style="text-align: left;">mean of 5 values</td>
<td style="text-align: left;">m3/m-3</td>
</tr>
<tr class="even">
<td style="text-align: left;">“Ka_40cm_[1-3]”</td>
<td style="text-align: left;">mean of 5 values</td>
<td style="text-align: left;">1..80</td>
</tr>
<tr class="odd">
<td style="text-align: left;">“T_40cm_[1-3]”</td>
<td style="text-align: left;">mean of 5 values</td>
<td style="text-align: left;">C</td>
</tr>
<tr class="even">
<td style="text-align: left;">“BulkEC_40cm_[1-3]”</td>
<td style="text-align: left;">mean of 5 values</td>
<td style="text-align: left;">dS/m</td>
</tr>
<tr class="odd">
<td style="text-align: left;">“VWC_50cm_[1-3]”</td>
<td style="text-align: left;">mean of 5 values</td>
<td style="text-align: left;">m3/m-3</td>
</tr>
<tr class="even">
<td style="text-align: left;">“Ka_50cm_[1-3]”</td>
<td style="text-align: left;">mean of 5 values</td>
<td style="text-align: left;">1..80</td>
</tr>
<tr class="odd">
<td style="text-align: left;">“T_50cm_[1-3]”</td>
<td style="text-align: left;">mean of 5 values</td>
<td style="text-align: left;">C</td>
</tr>
<tr class="even">
<td style="text-align: left;">“BulkEC_50cm_[1-3]”</td>
<td style="text-align: left;">mean of 5 values</td>
<td style="text-align: left;">dS/m</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</section></section><section id="data-processing-in-r" class="level1" data-number="6"><h1 data-number="6">
<span class="header-section-number">6</span> Data processing in R</h1>
<p>The logged data are imported into R from files created by Campbell Scientific’s PC400 program. The files are read using function read_csi_dat()` from package ‘photobiologyInOut’. The data now in data frames are checked for duplicate rows, outlier values, and time shifts. Problems are corrected when possible or data replaced by NAs when recovery is not possible.</p>
<p>In a separate step, R scripts are used to merge data in the different files created during import into R. Validated calibrations and corrections are applied obtaining a single data object with all data logged at a given frequency and new summaries computed for variables logged at higher frequencies. The new scripts do additional computations than those from version 1 including combining the data from the three soil profile sensors into single median values. This is most noticeable for data at 1 h and 1 d time steps. In the case of daily data we use days at UTC rather than local time. As far as I am aware this is the same approach used by the Finnish Meteorological Institute. The time for hourly summaries follows UTC and matches approach used by the Finnish Meteorological Institute, the reported time is that at the start/end of the hour for which data are averaged.</p>
<p>Additional quantities are calculated and added to the data set, including solar time, sun elevation and sun azimuth based on geographic coordinates and UTC time <a href="#tbl-r-script" class="quarto-xref">Table&nbsp;4</a>. The position of the sun and solar time are computed using Meuss (1998) very accurate equations as implemented in R package ‘photobiology’. The coordinates of the weather station are for the locations of the mast, with radiation sensors within 1.5 m of it, and soil sensors within 10 m. The accuracy is that allowed by the image layer of the free version of Google Maps with high resolution imagery.</p>
<div id="tbl-r-script" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-r-script-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4: Some quantities are computed and added to the data set. Based on the “TIMESTAMP” stored by the datalogger (and its difference from UTC time) and the geographic coordinates of the station, the sun position and solar time are computed and added to the data. “TIMESTAMP” is deleted and replaced by “time” and the quantities in this table.
</figcaption><div aria-describedby="tbl-r-script-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead><tr class="header">
<th style="text-align: left;">Quantity</th>
<th style="text-align: left;">Summary</th>
<th style="text-align: left;">Units</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">“time”</td>
<td style="text-align: left;">sample</td>
<td style="text-align: left;">yyyy-mm-dd hh:mm:ss UTC</td>
</tr>
<tr class="even">
<td style="text-align: left;">“day_of_year”</td>
<td style="text-align: left;">sample</td>
<td style="text-align: left;">numeric</td>
</tr>
<tr class="odd">
<td style="text-align: left;">“month_of_year”</td>
<td style="text-align: left;">sample</td>
<td style="text-align: left;">1..12</td>
</tr>
<tr class="even">
<td style="text-align: left;">“month_name”</td>
<td style="text-align: left;">sample</td>
<td style="text-align: left;">character</td>
</tr>
<tr class="odd">
<td style="text-align: left;">“calendar_year”</td>
<td style="text-align: left;">sample</td>
<td style="text-align: left;">numeric</td>
</tr>
<tr class="even">
<td style="text-align: left;">“time_of_day”</td>
<td style="text-align: left;">sample</td>
<td style="text-align: left;">numeric</td>
</tr>
<tr class="odd">
<td style="text-align: left;">“solar_time”</td>
<td style="text-align: left;">sample</td>
<td style="text-align: left;">numeric</td>
</tr>
<tr class="even">
<td style="text-align: left;">“sun_elevation”</td>
<td style="text-align: left;">sample</td>
<td style="text-align: left;">degrees</td>
</tr>
<tr class="odd">
<td style="text-align: left;">“sun_azimuth”</td>
<td style="text-align: left;">sample</td>
<td style="text-align: left;">degrees</td>
</tr>
<tr class="even">
<td style="text-align: left;">“PAR_BF_diff_fr”</td>
<td style="text-align: left;">sample</td>
<td style="text-align: left;">/1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">“PAR_diff_fr_rel”</td>
<td style="text-align: left;">sample</td>
<td style="text-align: left;">/1</td>
</tr>
<tr class="even">
<td style="text-align: left;">“was_sunny”</td>
<td style="text-align: left;">sample</td>
<td style="text-align: left;">logical</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Most calibrations are applied at this stage. (To facilitate monitoring a calibration is used in the logger for most sensors, but small additional adjustments based on calibrations done after the logger program was written are applied off-line)</p>
<p>Variable <code>was_sunny</code> indicates occlusion or not of the solar disk, estimated based on the deviation from the expected fraction of diffuse PAR at the current sun elevation. The reference value is derived from spectral irradiance simulations done with the TUV radiation transfer and atmosphere photochemistry model TUV. The variable is set to <code>NA</code> when the sun is below the horizon or diffuse PAR irradiance is less than 5 <span class="math inline">\(\mathrm{\mu mol\,m^{-2}\,s^{-1}}\)</span>.</p>
<p>The irradiances of UV-A1 and UV-A2 are derived from the measured UV-A, UV-B and blue irradiances, based on calibrations on-site against a spectrometer. The UV-A irradiance measurements are also corrected for the temperature coefficient of the sensor as published <a href="https://download.sglux.de/publications/sglux_SiC_Temperature_Coefficient.pdf">Langer 2020</a>, taking into account spectral dependence of the temperature and radiation responses and the shape of the solar spectrum.</p>
<p>A new UV-A1 sensor will put in service during 2024.</p>
</section><section id="information-about-the-published-data" class="level1" data-number="7"><h1 data-number="7">
<span class="header-section-number">7</span> Information about the published data</h1>
<p>In the examples below, we use R to read the data from <code>.rda</code> files, but the same data are also available as comma separated values (CSV) in Gnu Zip (gzip) compressed files.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"F:/aphalo/research-data/data-weather/RFR-Viikki-field/data-rda/second_2024_latest.tb.rda"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/comment.html">comment</a></span><span class="op">(</span><span class="va">second_2024_latest.tb</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>File: Viikki Tower_TableSecond.dat
---
TOA5    Viikki Tower    CR6 1449    CR6.Std.13.02   CPU:TowerViikki2024-05-fast.CR6 59671   TableSecond
---
TIMESTAMP   TS  
RECORD  RN  
PAR_Den µmol/s/m²   Avg
PAR_Den_CS  µmol/s/m²   Avg
PAR_BF_tot  µmol/s/m²   Avg
PAR_BF_diff µmol/s/m²   Avg
Red_Den_cal µmol/s/m²   Avg
Far_red_Den_cal µmol/s/m²   Avg
Blue_Den    mV  Avg
UVA_Den mV  Avg
UVB_Den mV  Avg
Solar_irrad W/m²    Avg
SurfTemp_grnd   Celsius Avg
SurfTemp_veg    Celsius Avg</code></pre>
</div>
</div>
<p><strong>The data set at 1 second interval</strong> has 4687479 rows and 35 variables.</p>
<p>The variables are series_start, time, day_of_year, month_of_year, month_name, calendar_year, time_of_day, solar_time, sun_elevation, sun_azimuth, PAR_umol_CS, PAR_umol_BF, PAR_umol, PAR_diff_fr, red_umol, far_red_umol, blue_umol, blue_sellaro_umol, UVA_umol, UVA1_umol, UVA2_umol, UVB_umol, blue_red, blue_red_sq, UVA_PAR, UVA_PAR_sq, UVA1_PAR, UVA1_PAR_sq, UVA2_PAR, UVA2_PAR_sq, UVB_PAR, UVB_PAR_sq, red_far_red, global_irrad, solar_disk.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"F:/aphalo/research-data/data-weather/RFR-Viikki-field/data-rda/minute_2024_latest.tb.rda"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/comment.html">comment</a></span><span class="op">(</span><span class="va">minute_2024_latest.tb</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>The data set at 1 min interval</strong> has 39064 rows and 60 variables.</p>
<p>The variables are series_start, time, day_of_year, month_of_year, month_name, calendar_year, time_of_day, solar_time, sun_elevation, sun_azimuth, PAR_umol_LI, PAR_umol_CS, PAR_umol_BF, PAR_umol, PAR_diff_fr, global_watt, red_umol, far_red_umol, blue_umol, blue_sellaro_umol, UVA_umol, UVA1_umol, UVA2_umol, UVB_umol, blue_red, blue_red_sq, UVA_PAR, UVA_PAR_sq, UVA1_PAR, UVA1_PAR_sq, UVA2_PAR, UVA2_PAR_sq, UVB_PAR, UVB_PAR_sq, red_far_red, wind_speed, wind_direction, air_temp_C, air_vp, air_RH, air_DP, air_pressure, rain_mm_min, surf_temp_C, surf_temp_sensor_delta_C, was_sunny, solar_time_h, was_day, PAR_diff_fr_rel, logged_air_temp_C, air_temp_run_median, temp_surf2air_C, R_0, R_rel, Rn_sw_ref, Rn_ref, ET_ref_FAO56, ET_ref_short, ET_ref_tall, air_vpd.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"F:/aphalo/research-data/data-weather/RFR-Viikki-field/data-rda/hour_2024_latest.tb.rda"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/comment.html">comment</a></span><span class="op">(</span><span class="va">hour_2024_latest.tb</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>The data set at 1 h interval</strong> has 652 rows and 203 variables. The variables are time, time_start, time_end, day_of_year, month_of_year, month_name, calendar_year, time_of_day, solar_time, sun_elevation, sun_azimuth, PAR_umol_LI_mean, PAR_umol_LI_min, PAR_umol_LI_max, PAR_umol_CS_mean, PAR_umol_CS_min, PAR_umol_CS_max, PAR_umol_BF_mean, PAR_umol_BF_min, PAR_umol_BF_max, PAR_umol_mean, PAR_umol_min, PAR_umol_max, PAR_diff_fr_mean, PAR_diff_fr_min, PAR_diff_fr_max, global_watt_mean, global_watt_min, global_watt_max, red_umol_mean, red_umol_min, red_umol_max, far_red_umol_mean, far_red_umol_min, far_red_umol_max, blue_umol_mean, blue_umol_min, blue_umol_max, blue_sellaro_umol_mean, blue_sellaro_umol_min, blue_sellaro_umol_max, UVA_umol_mean, UVA_umol_min, UVA_umol_max, UVA1_umol_mean, UVA1_umol_min, UVA1_umol_max, UVA2_umol_mean, UVA2_umol_min, UVA2_umol_max, UVB_umol_mean, UVB_umol_min, UVB_umol_max, blue_red_mean, blue_red_min, blue_red_max, blue_red_sq_mean, blue_red_sq_min, blue_red_sq_max, UVA_PAR_mean, UVA_PAR_min, UVA_PAR_max, UVA_PAR_sq_mean, UVA_PAR_sq_min, UVA_PAR_sq_max, UVA1_PAR_mean, UVA1_PAR_min, UVA1_PAR_max, UVA1_PAR_sq_mean, UVA1_PAR_sq_min, UVA1_PAR_sq_max, UVA2_PAR_mean, UVA2_PAR_min, UVA2_PAR_max, UVA2_PAR_sq_mean, UVA2_PAR_sq_min, UVA2_PAR_sq_max, UVB_PAR_mean, UVB_PAR_min, UVB_PAR_max, UVB_PAR_sq_mean, UVB_PAR_sq_min, UVB_PAR_sq_max, red_far_red_mean, red_far_red_min, red_far_red_max, wind_speed_mean, wind_speed_min, wind_speed_max, wind_direction_mean, wind_direction_min, wind_direction_max, air_temp_C_mean, air_temp_C_min, air_temp_C_max, air_vp_mean, air_vp_min, air_vp_max, air_RH_mean, air_RH_min, air_RH_max, air_DP_mean, air_DP_min, air_DP_max, air_pressure_mean, air_pressure_min, air_pressure_max, surf_temp_C_mean, surf_temp_C_min, surf_temp_C_max, surf_temp_sensor_delta_C_mean, surf_temp_sensor_delta_C_min, surf_temp_sensor_delta_C_max, PAR_diff_fr_rel_mean, logged_air_temp_C_mean, air_temp_run_median_mean, temp_surf2air_C_mean, R_0_mean, R_rel_mean, Rn_sw_ref_mean, Rn_ref_mean, ET_ref_FAO56_mean, ET_ref_short_mean, ET_ref_tall_mean, air_vpd_mean, PAR_diff_fr_rel_max, logged_air_temp_C_max, air_temp_run_median_max, temp_surf2air_C_max, R_0_max, R_rel_max, Rn_sw_ref_max, Rn_ref_max, ET_ref_FAO56_max, ET_ref_short_max, ET_ref_tall_max, air_vpd_max, PAR_diff_fr_rel_min, logged_air_temp_C_min, air_temp_run_median_min, temp_surf2air_C_min, R_0_min, R_rel_min, Rn_sw_ref_min, Rn_ref_min, ET_ref_FAO56_min, ET_ref_short_min, ET_ref_tall_min, air_vpd_min, rain_mm_h, was_sunny, was_day, n, RECORD, VWC_1, EC_1, T_1, VWC_2, EC_2, T_2, VWC_3, EC_3, T_3, VWC_5cm_1, T107_C_Avg(1), T107_C_Avg(2), T107_C_Avg(3), T107_C_Avg(4), SupplyVoltage_Min, SupplyVoltage_Max, BattV_Min, BattV_Max, ReferenceVoltage_Min, ReferenceVoltage_Max, PTemp_C_Min, PTemp_C_TMn, PTemp_C_Max, PTemp_C_TMx, Satus.Low12VCount, T_5cm, T_10cm, T_20cm, T_30cm, T_40cm, T_50cm, VWC_5cm, VWC_10cm, VWC_20cm, VWC_30cm, VWC_40cm, VWC_50cm, Ka_5cm, Ka_10cm, Ka_20cm, Ka_30cm, Ka_40cm, Ka_50cm, BulkEC_5cm, BulkEC_10cm, BulkEC_20cm, BulkEC_30cm, BulkEC_40cm, BulkEC_50cm.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"F:/aphalo/research-data/data-weather/RFR-Viikki-field/data-rda/day_2024_latest.tb.rda"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/comment.html">comment</a></span><span class="op">(</span><span class="va">hour_2024_latest.tb</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>The data set at 1 d interval</strong> has 28 rows and 173 variables. The variables are time, date, PAR_umol_mean, PAR_mol_day, PAR_umol_min, PAR_umol_max, UVB_umol_mean, UVB_mol_day, UVB_umol_min, UVB_umol_max, UVA2_umol_mean, UVA2_mol_day, UVA2_umol_min, UVA2_umol_max, UVA1_umol_mean, UVA1_mol_day, UVA1_umol_min, UVA1_umol_max, UVA_umol_mean, UVA_mol_day, UVA_umol_min, UVA_umol_max, global_watt_mean, global_MJ_day, global_watt_min, global_watt_max, air_temp_C_mean, air_temp_C_min, air_temp_C_max, air_vp_mean, air_vp_min, air_vp_max, surf_temp_C_mean, surf_temp_C_min, surf_temp_C_max, surf_temp_sensor_delta_C_mean, surf_temp_sensor_delta_C_min, surf_temp_sensor_delta_C_max, sunny_hours, rain_mm_day, n_minutes, PAR_diff_fr_rel_mean, logged_air_temp_C_mean, air_temp_run_median_mean, temp_surf2air_C_mean, R_0_mean, R_rel_mean, Rn_sw_ref_mean, Rn_ref_mean, ET_ref_FAO56_mean, ET_ref_short_mean, ET_ref_tall_mean, air_vpd_mean, PAR_diff_fr_rel_max, logged_air_temp_C_max, air_temp_run_median_max, temp_surf2air_C_max, R_0_max, R_rel_max, Rn_sw_ref_max, Rn_ref_max, ET_ref_FAO56_max, ET_ref_short_max, ET_ref_tall_max, air_vpd_max, PAR_diff_fr_rel_min, logged_air_temp_C_min, air_temp_run_median_min, temp_surf2air_C_min, R_0_min, R_rel_min, Rn_sw_ref_min, Rn_ref_min, ET_ref_FAO56_min, ET_ref_short_min, ET_ref_tall_min, air_vpd_min, ET_ref_FAO56_mm_day, ET_ref_short_mm_day, ET_ref_tall_mm_day, T_5cm_mean, T_5cm_min, T_5cm_max, T_10cm_mean, T_10cm_min, T_10cm_max, T_20cm_mean, T_20cm_min, T_20cm_max, T_30cm_mean, T_30cm_min, T_30cm_max, T_40cm_mean, T_40cm_min, T_40cm_max, T_50cm_mean, T_50cm_min, T_50cm_max, VWC_5cm_mean, VWC_5cm_min, VWC_5cm_max, VWC_10cm_mean, VWC_10cm_min, VWC_10cm_max, VWC_20cm_mean, VWC_20cm_min, VWC_20cm_max, VWC_30cm_mean, VWC_30cm_min, VWC_30cm_max, VWC_40cm_mean, VWC_40cm_min, VWC_40cm_max, VWC_50cm_mean, VWC_50cm_min, VWC_50cm_max, Ka_5cm_mean, Ka_5cm_min, Ka_5cm_max, Ka_10cm_mean, Ka_10cm_min, Ka_10cm_max, Ka_20cm_mean, Ka_20cm_min, Ka_20cm_max, Ka_30cm_mean, Ka_30cm_min, Ka_30cm_max, Ka_40cm_mean, Ka_40cm_min, Ka_40cm_max, Ka_50cm_mean, Ka_50cm_min, Ka_50cm_max, BulkEC_5cm_mean, BulkEC_5cm_min, BulkEC_5cm_max, BulkEC_10cm_mean, BulkEC_10cm_min, BulkEC_10cm_max, BulkEC_20cm_mean, BulkEC_20cm_min, BulkEC_20cm_max, BulkEC_30cm_mean, BulkEC_30cm_min, BulkEC_30cm_max, BulkEC_40cm_mean, BulkEC_40cm_min, BulkEC_40cm_max, BulkEC_50cm_mean, BulkEC_50cm_min, BulkEC_50cm_max, VWC_5cm_day_start, VWC_5cm_day_end, VWC_5cm_day_delta, VWC_10cm_day_start, VWC_10cm_day_end, VWC_10cm_day_delta, VWC_20cm_day_start, VWC_20cm_day_end, VWC_20cm_day_delta, VWC_30cm_day_start, VWC_30cm_day_end, VWC_30cm_day_delta, VWC_40cm_day_start, VWC_40cm_day_end, VWC_40cm_day_delta, VWC_50cm_day_start, VWC_50cm_day_end, VWC_50cm_day_delta, water_mm_0to55cm_start, water_mm_0to55cm_end, water_mm_0to55cm_delta.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>A detailed data dictionary will be added soon to the data objects themselves. Data are in SI units and in most cases without scale factors. The units described for the logged data in the tables above are not modified except for sensors for which mV signals are logged.</p>
</div>
</div>
</section><section id="example-plots" class="level1" data-number="8"><h1 data-number="8">
<span class="header-section-number">8</span> Example plots</h1>
<p>Using data saved at 1 min interval we can compute empirical desity distributions, showing how frequently different values have been observed.</p>
<section id="par-photon-irradiance" class="level2" data-number="8.1"><h2 data-number="8.1" class="anchored" data-anchor-id="par-photon-irradiance">
<span class="header-section-number">8.1</span> PAR photon irradiance</h2>
<p>Photosynthetically active radiation photon irradiance at Viikki, Helsinki, presented as fitted empirical density functions for each month of the year <a href="#fig-PAR-month-sec" class="quarto-xref">Figure&nbsp;2</a>. During winter-time some snow from time to time accumulated on the sensor may have distorted the distribution to some extent. (Each curve in the plot can be thought as equivalent to a smoothed-out histogram, scaled to an area of one.)</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">second_2024_latest.tb</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">sun_elevation</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">PAR_umol</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">month_name</span>, <span class="va">PAR_umol</span>, <span class="va">calendar_year</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">PAR_umol</span>, y <span class="op">=</span> <span class="va">month_name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://docs.r4photobiology.info/ggpp/reference/stat_panel_counts.html">stat_panel_counts</a></span><span class="op">(</span>label.y <span class="op">=</span> <span class="st">"top"</span>, label.x <span class="op">=</span> <span class="st">"right"</span>, size <span class="op">=</span> <span class="fl">3.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://wilkelab.org/ggridges/reference/geom_density_ridges.html">geom_density_ridges</a></span><span class="op">(</span>na.rm <span class="op">=</span> <span class="cn">TRUE</span>, scale <span class="op">=</span> <span class="fl">2.5</span>, fill <span class="op">=</span> <span class="st">"yellow"</span>, alpha <span class="op">=</span> <span class="fl">0.33</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_log10</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.03</span>, <span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">10</span>, <span class="fl">30</span>, <span class="fl">100</span>, <span class="fl">300</span>, <span class="fl">1000</span>, <span class="fl">3000</span><span class="op">)</span>, </span>
<span>                minor_breaks <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/format_format.html">format_format</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span>, scientific <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_y_discrete</a></span><span class="op">(</span>drop<span class="op">=</span><span class="cn">FALSE</span>, expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">3000</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">PAR</span><span class="op">~</span><span class="op">~</span><span class="va">photon</span><span class="op">~</span><span class="op">~</span><span class="va">irradiance</span><span class="op">~</span><span class="op">~</span><span class="op">(</span><span class="va">mu</span><span class="op">*</span><span class="va">mol</span><span class="op">~</span><span class="va">m</span><span class="op">^</span><span class="op">{</span><span class="op">-</span><span class="fl">2</span><span class="op">}</span><span class="op">~</span><span class="va">s</span><span class="op">^</span><span class="op">{</span><span class="op">-</span><span class="fl">1</span><span class="op">}</span><span class="op">)</span><span class="op">)</span>, y <span class="op">=</span> <span class="st">"Month of the year"</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">par_month_rigdes.fig</span></span>
<span><span class="va">par_month_rigdes.fig</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 0.0273</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-PAR-month-sec" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-PAR-month-sec-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="station-data-description-2_files/figure-html/fig-PAR-month-sec-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-PAR-month-sec-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Empirical density of photosynthetically active radiation (PAR) irradiances by month of the year. The density curves have been fitted to 0.5 s averages computed from data acquired once every 50 ms.
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">minute_2024_latest.tb</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">sun_elevation</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">PAR_umol</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">month_name</span>, <span class="va">PAR_umol</span>, <span class="va">calendar_year</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">PAR_umol</span>, y <span class="op">=</span> <span class="va">month_name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://docs.r4photobiology.info/ggpp/reference/stat_panel_counts.html">stat_panel_counts</a></span><span class="op">(</span>label.y <span class="op">=</span> <span class="st">"top"</span>, label.x <span class="op">=</span> <span class="st">"right"</span>, size <span class="op">=</span> <span class="fl">3.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://wilkelab.org/ggridges/reference/geom_density_ridges.html">geom_density_ridges</a></span><span class="op">(</span>na.rm <span class="op">=</span> <span class="cn">TRUE</span>, scale <span class="op">=</span> <span class="fl">2.5</span>, fill <span class="op">=</span> <span class="st">"yellow"</span>, alpha <span class="op">=</span> <span class="fl">0.33</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_log10</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.03</span>, <span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">10</span>, <span class="fl">30</span>, <span class="fl">100</span>, <span class="fl">300</span>, <span class="fl">1000</span>, <span class="fl">3000</span><span class="op">)</span>, </span>
<span>                minor_breaks <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/format_format.html">format_format</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span>, scientific <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_y_discrete</a></span><span class="op">(</span>drop<span class="op">=</span><span class="cn">FALSE</span>, expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">3000</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">PAR</span><span class="op">~</span><span class="op">~</span><span class="va">photon</span><span class="op">~</span><span class="op">~</span><span class="va">irradiance</span><span class="op">~</span><span class="op">~</span><span class="op">(</span><span class="va">mu</span><span class="op">*</span><span class="va">mol</span><span class="op">~</span><span class="va">m</span><span class="op">^</span><span class="op">{</span><span class="op">-</span><span class="fl">2</span><span class="op">}</span><span class="op">~</span><span class="va">s</span><span class="op">^</span><span class="op">{</span><span class="op">-</span><span class="fl">1</span><span class="op">}</span><span class="op">)</span><span class="op">)</span>, y <span class="op">=</span> <span class="st">"Month of the year"</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">par_month_rigdes.fig</span></span>
<span><span class="va">par_month_rigdes.fig</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 0.071</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-PAR-month-min" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-PAR-month-min-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="station-data-description-2_files/figure-html/fig-PAR-month-min-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-PAR-month-min-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Empirical density of photosynthetically active radiation (PAR) irradiances by month of the year. The density curves have been fitted to 1 min averages computed from data acquired once every 50 ms.
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">hour_2024_latest.tb</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">sun_elevation</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">PAR_umol_mean</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">month_name</span>, <span class="va">PAR_umol_mean</span>, <span class="va">calendar_year</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">PAR_umol_mean</span>, y <span class="op">=</span> <span class="va">month_name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://docs.r4photobiology.info/ggpp/reference/stat_panel_counts.html">stat_panel_counts</a></span><span class="op">(</span>label.y <span class="op">=</span> <span class="st">"top"</span>, label.x <span class="op">=</span> <span class="st">"right"</span>, size <span class="op">=</span> <span class="fl">3.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://wilkelab.org/ggridges/reference/geom_density_ridges.html">geom_density_ridges</a></span><span class="op">(</span>na.rm <span class="op">=</span> <span class="cn">TRUE</span>, scale <span class="op">=</span> <span class="fl">2.5</span>, fill <span class="op">=</span> <span class="st">"yellow"</span>, alpha <span class="op">=</span> <span class="fl">0.33</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_log10</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.03</span>, <span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">10</span>, <span class="fl">30</span>, <span class="fl">100</span>, <span class="fl">300</span>, <span class="fl">1000</span>, <span class="fl">3000</span><span class="op">)</span>, </span>
<span>                minor_breaks <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/format_format.html">format_format</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span>, scientific <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_y_discrete</a></span><span class="op">(</span>drop<span class="op">=</span><span class="cn">FALSE</span>, expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">3000</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">PAR</span><span class="op">~</span><span class="op">~</span><span class="va">photon</span><span class="op">~</span><span class="op">~</span><span class="va">irradiance</span><span class="op">~</span><span class="op">~</span><span class="op">(</span><span class="va">mu</span><span class="op">*</span><span class="va">mol</span><span class="op">~</span><span class="va">m</span><span class="op">^</span><span class="op">{</span><span class="op">-</span><span class="fl">2</span><span class="op">}</span><span class="op">~</span><span class="va">s</span><span class="op">^</span><span class="op">{</span><span class="op">-</span><span class="fl">1</span><span class="op">}</span><span class="op">)</span><span class="op">)</span>, y <span class="op">=</span> <span class="st">"Month of the year"</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">par_month_rigdes.fig</span></span>
<span><span class="va">par_month_rigdes.fig</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 0.148</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-PAR-month-hour" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-PAR-month-hour-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="station-data-description-2_files/figure-html/fig-PAR-month-hour-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-PAR-month-hour-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Empirical density of photosynthetically active radiation (PAR) irradiances by month of the year. The density curves have been fitted to 1 h averages computed from data acquired once every 50 ms.
</figcaption></figure>
</div>
</div>
</div>
</section><section id="soil-temperature-profile" class="level2" data-number="8.2"><h2 data-number="8.2" class="anchored" data-anchor-id="soil-temperature-profile">
<span class="header-section-number">8.2</span> Soil temperature profile</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"F:/aphalo/research-data/data-weather/RFR-Viikki-field/data-rda/hour_2024_latest.tb.rda"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">hour_2024_latest.tb</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">month_of_year</span>, <span class="va">day_of_year</span>, <span class="va">calendar_year</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"T_"</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">ends_with</a></span><span class="op">(</span><span class="st">"cm"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"T_"</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"layer"</span>, values_to <span class="op">=</span> <span class="st">"soil_t"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>depth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"T_|cm"</span>, <span class="st">""</span>, <span class="va">layer</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">soil_temperature.tb</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In <a href="#fig-soil-temp-depth" class="quarto-xref">Figure&nbsp;5</a> the soil temperature depth profile is shown. It is summarised using quantile regression for the 5%, 50% and 95% percentiles. This highlights the range of variation at different depths on different months of the year. The data values, not plotted, are medians from three sensors, logged once every 1 h..</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">soil_temperature.tb</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">depth</span>, <span class="va">soil_t</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://docs.r4photobiology.info/ggpmisc/reference/stat_quant_band.html">stat_quant_band</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">5</span>, raw <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, quantiles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Soil temperature (C)"</span>, x <span class="op">=</span> <span class="st">"Depth (cm)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">month.name</span><span class="op">[</span><span class="va">month_of_year</span><span class="op">]</span>, levels <span class="op">=</span> <span class="va">month.name</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">month_of_year</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="co">#  scale_x_continuous(trans = "reverse") +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">soil_t.fig</span></span>
<span><span class="va">soil_t.fig</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-soil-temp-depth" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-soil-temp-depth-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="station-data-description-2_files/figure-html/fig-soil-temp-depth-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-soil-temp-depth-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Soil-temperature depth profile for each month of the year.
</figcaption></figure>
</div>
</div>
</div>
<p>In <a href="#fig-soil-temp-time-course" class="quarto-xref">Figure&nbsp;6</a> we show hourly temperatures at different depths over a few days, showing the daily warming and cooling of the mostly bare soil. The data values shown are medians from three sensors, acquired once every 1 h.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">soil_temperature.tb</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span><span class="co">#  filter(day_of_year &gt; 190 &amp; day_of_year &lt; 200 &amp; calendar_year == 2024) %&gt;%</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">soil_t</span>, colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">depth</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Soil temperature (C)"</span>, x <span class="op">=</span> <span class="st">"Time"</span>,</span>
<span>       colour <span class="op">=</span> <span class="st">"Depth (cm)"</span><span class="op">)</span>  <span class="op">-&gt;</span> <span class="va">soil_t_daily.fig</span></span>
<span><span class="va">soil_t_daily.fig</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-soil-temp-time-course" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-soil-temp-time-course-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="station-data-description-2_files/figure-html/fig-soil-temp-time-course-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-soil-temp-time-course-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Soil-temperature time course at nine different depths during nine consecutive days in the Summer of year 2020. Data logged once per every 1 h.
</figcaption></figure>
</div>
</div>
</div>


<!-- -->

</section></section><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a></div></div></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb17" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Data acquired and computed - Version 2"</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Quantities published and their origin"</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Pedro J. Aphalo (SenPEP)"</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> 2024-06-11</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="an">date-modified:</span><span class="co"> 2024-06-11</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="an">date-meta:</span><span class="co"> "`r Sys.Date()`"</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="an">abstract:</span><span class="co"> |</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co">  This page describes the data available from the weather station at the Viikki campus of the University of Helsinki, at Helsinki, Finland, since May 2024. </span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="an">keywords:</span><span class="co"> [datalogger,data processing,published data]</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> [Methods]</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> </span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co">  markdown: </span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co">    wrap: 72</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="co">  html: </span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="co">    code-link: true</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="an">draft:</span><span class="co"> false</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup, echo=FALSE}</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::opts_chunk$set(tidy = FALSE, cache = FALSE)</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE}</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyverse)</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggridges)</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggpmisc)</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a><span class="in">library(lubridate)</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a><span class="fu"># What makes data from this weather station different?</span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Time interval for acquisition of light measurements (From 2024-05-14):</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>    50 ms.</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Time interval for logging of summaries (From 2024-05-14): 50 ms, 500 ms, 1 min, 1 h.</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Solar radiation measurement: seven types of broadband</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>    sensors, to increase to eight.</span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Soil measurements as a depth profile.</span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Data summaries provided as a free service for research at the experimental</span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>    field of the Viikki campus.</span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Data for state-of-the-art research on the spectrum of sunlight and</span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>    its fast variation.</span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Open access to these data, deposited under a citable DOI.</span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a><span class="fu"># Data availability</span></span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Open access through Open Science Foundation</span><span class="co">](https://osf.io/e4vau/)</span></span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a>under <span class="co">[</span><span class="ot">DOI 10.17605/OSF.IO/E4VAU</span><span class="co">](https:doi.org/10.17605/OSF.IO/E4VAU)</span>.</span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a>To be cited, after adding date when the site was visited to download the</span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a>data, as:</span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a>Aphalo, Pedro J. 2024. _High Frequency Weather Data for Viikki,</span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a>Helsinki, Finland._ OSF. doi:10.17605/OSF.IO/E4VAU.</span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a><span class="fu"># Limitations of the data</span></span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a>Radiation data in winter months are parply unreliable as the sensors lack a</span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a>blower to keep the snow away. Some of the radiation sensors have heating but</span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a>this does not help much with sticky snow. Precipitation as snow or sleet is not</span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a>detected by the weather transmitter, and also wind measurements can be</span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a>potentially affected by snow and ice accumulation even with heating. Other</span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a>variables can be trusted year-round. The intention of this station was initially</span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a>to *take readings during the growing season*. The data in the files include</span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a>winter values for all variables, including those which are expected not reliable</span>
<span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a>on many days between mid November and late March, and a few days in April.</span>
<span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a>DATA ARE PROVIDED AS IS, WITH NO GUARANTEE, even if the station is managed</span>
<span id="cb17-78"><a href="#cb17-78" aria-hidden="true" tabindex="-1"></a>as carefully with the limited resources available.</span>
<span id="cb17-79"><a href="#cb17-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-80"><a href="#cb17-80" aria-hidden="true" tabindex="-1"></a><span class="fu"># The data flow</span></span>
<span id="cb17-81"><a href="#cb17-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-82"><a href="#cb17-82" aria-hidden="true" tabindex="-1"></a>The acquisition and summarizing of data requires multiples steps, some</span>
<span id="cb17-83"><a href="#cb17-83" aria-hidden="true" tabindex="-1"></a>performed on board the datalogger and some in a computer</span>
<span id="cb17-84"><a href="#cb17-84" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">@fig-data-flow-chart</span><span class="co">]</span>. The program in the logger is written in CRBasic,</span>
<span id="cb17-85"><a href="#cb17-85" aria-hidden="true" tabindex="-1"></a>data are downloaded through a USB connection to a laptop computer in the</span>
<span id="cb17-86"><a href="#cb17-86" aria-hidden="true" tabindex="-1"></a>field, using the program <span class="co">[</span><span class="ot">PC400</span><span class="co">](https://www.campbellsci.com/pc400)</span>.</span>
<span id="cb17-87"><a href="#cb17-87" aria-hidden="true" tabindex="-1"></a>Later computations are done with R scripts that make use of packages</span>
<span id="cb17-88"><a href="#cb17-88" aria-hidden="true" tabindex="-1"></a>from the [R for Photobiology</span>
<span id="cb17-89"><a href="#cb17-89" aria-hidden="true" tabindex="-1"></a>Suite](https://www.r4photobiology.info/pages/r4p-introduction.html)</span>
<span id="cb17-90"><a href="#cb17-90" aria-hidden="true" tabindex="-1"></a>(Aphalo2025)</span>
<span id="cb17-91"><a href="#cb17-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-92"><a href="#cb17-92" aria-hidden="true" tabindex="-1"></a>The scripts and logger program had to be rewritten to make it possible faster</span>
<span id="cb17-93"><a href="#cb17-93" aria-hidden="true" tabindex="-1"></a>measurements. Fewer computations are carried out on the logger and more are</span>
<span id="cb17-94"><a href="#cb17-94" aria-hidden="true" tabindex="-1"></a>done off-line. Data are logged in general at the fastest rate possible or needed</span>
<span id="cb17-95"><a href="#cb17-95" aria-hidden="true" tabindex="-1"></a>and value at slower rates are computed off-line. At the moment, only new data</span>
<span id="cb17-96"><a href="#cb17-96" aria-hidden="true" tabindex="-1"></a>are being processed with the new scripts. The operations are the same but</span>
<span id="cb17-97"><a href="#cb17-97" aria-hidden="true" tabindex="-1"></a>with different acquisition frequency slight differences are possible between</span>
<span id="cb17-98"><a href="#cb17-98" aria-hidden="true" tabindex="-1"></a>version 1 and version 2 data sets.</span>
<span id="cb17-99"><a href="#cb17-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-100"><a href="#cb17-100" aria-hidden="true" tabindex="-1"></a>In version 2 a master script calls the other scripts. The intention is to</span>
<span id="cb17-101"><a href="#cb17-101" aria-hidden="true" tabindex="-1"></a>publish also daily summaries, which were not distributed until now.</span>
<span id="cb17-102"><a href="#cb17-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-105"><a href="#cb17-105" aria-hidden="true" tabindex="-1"></a><span class="in">```{mermaid}</span></span>
<span id="cb17-106"><a href="#cb17-106" aria-hidden="true" tabindex="-1"></a><span class="in">%%| label: fig-data-flow-chart</span></span>
<span id="cb17-107"><a href="#cb17-107" aria-hidden="true" tabindex="-1"></a><span class="in">%%| fig-cap: "Simplified flowchart of the steps from data acquisition to publication of the data."</span></span>
<span id="cb17-108"><a href="#cb17-108" aria-hidden="true" tabindex="-1"></a><span class="in">flowchart TD</span></span>
<span id="cb17-109"><a href="#cb17-109" aria-hidden="true" tabindex="-1"></a><span class="in">    A((Datalogger:\nData acquisition)) -.-&gt; B</span></span>
<span id="cb17-110"><a href="#cb17-110" aria-hidden="true" tabindex="-1"></a><span class="in">    B[Datalogger:\n Computation of summaries\n and data storage] --&gt;|Download data| C</span></span>
<span id="cb17-111"><a href="#cb17-111" aria-hidden="true" tabindex="-1"></a><span class="in">    C[Computer with PC400:\n Data download from logger] --&gt;|Import data| D</span></span>
<span id="cb17-112"><a href="#cb17-112" aria-hidden="true" tabindex="-1"></a><span class="in">    D[Computer with R:\n Read most recent raw data file\n and validate data] -.-&gt; DD</span></span>
<span id="cb17-113"><a href="#cb17-113" aria-hidden="true" tabindex="-1"></a><span class="in">    DD[Computer with R:\n Save data to .Rda file\n and validate data] --&gt;|Read data| E</span></span>
<span id="cb17-114"><a href="#cb17-114" aria-hidden="true" tabindex="-1"></a><span class="in">    E[Computer with R:\n Read all data from .Rda files] -.-&gt; EE</span></span>
<span id="cb17-115"><a href="#cb17-115" aria-hidden="true" tabindex="-1"></a><span class="in">    EE[Computer with R:\n Apply sensor calibrations based on dates] -.-&gt; F</span></span>
<span id="cb17-116"><a href="#cb17-116" aria-hidden="true" tabindex="-1"></a><span class="in">    F[Computer with R:\n Merge data into a single time series] -.-&gt; G</span></span>
<span id="cb17-117"><a href="#cb17-117" aria-hidden="true" tabindex="-1"></a><span class="in">    G[Computer with R:\n compute derived quantities] -.-&gt; H</span></span>
<span id="cb17-118"><a href="#cb17-118" aria-hidden="true" tabindex="-1"></a><span class="in">    H[Computer with R:\n prepare metadata and add it to R objects] -.-&gt; I</span></span>
<span id="cb17-119"><a href="#cb17-119" aria-hidden="true" tabindex="-1"></a><span class="in">    I[Computer with R:\n save to .Rda and .CSV files] --&gt;|Upload| J((OSF repository:\n publish on line))</span></span>
<span id="cb17-120"><a href="#cb17-120" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-121"><a href="#cb17-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-122"><a href="#cb17-122" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb17-123"><a href="#cb17-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-124"><a href="#cb17-124" aria-hidden="true" tabindex="-1"></a>Over the eight years during which the station has been operational,</span>
<span id="cb17-125"><a href="#cb17-125" aria-hidden="true" tabindex="-1"></a>there have been changes in the installed sensors (described under</span>
<span id="cb17-126"><a href="#cb17-126" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Equipment used and site description</span><span class="co">](station.equipment.qmd)</span>), and in</span>
<span id="cb17-127"><a href="#cb17-127" aria-hidden="true" tabindex="-1"></a>the program run in the datalogger to acquire the data. Most of the</span>
<span id="cb17-128"><a href="#cb17-128" aria-hidden="true" tabindex="-1"></a>earlier changes to the program were related to the installation of new sensors.</span>
<span id="cb17-129"><a href="#cb17-129" aria-hidden="true" tabindex="-1"></a>However, recent changes to increase the data acquisition frequency meant that</span>
<span id="cb17-130"><a href="#cb17-130" aria-hidden="true" tabindex="-1"></a>the processing capacity and available memory in the logger became limiting.</span>
<span id="cb17-131"><a href="#cb17-131" aria-hidden="true" tabindex="-1"></a>To solve this problem we had to off-load some summary computations to</span>
<span id="cb17-132"><a href="#cb17-132" aria-hidden="true" tabindex="-1"></a>processing off-line.</span>
<span id="cb17-133"><a href="#cb17-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-134"><a href="#cb17-134" aria-hidden="true" tabindex="-1"></a>This change does not affect the continuity of the published time series data, as</span>
<span id="cb17-135"><a href="#cb17-135" aria-hidden="true" tabindex="-1"></a>the two approaches are numerically equivalent.</span>
<span id="cb17-136"><a href="#cb17-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-137"><a href="#cb17-137" aria-hidden="true" tabindex="-1"></a>The change in data acquisition frequency from once every 5 s to once</span>
<span id="cb17-138"><a href="#cb17-138" aria-hidden="true" tabindex="-1"></a>every 0.5 s on 2024-05-14, could in principle decrease the variability of</span>
<span id="cb17-139"><a href="#cb17-139" aria-hidden="true" tabindex="-1"></a>the 1 min summaries. However, the averaging period used for data</span>
<span id="cb17-140"><a href="#cb17-140" aria-hidden="true" tabindex="-1"></a>acquisition was decreased at the same time as the frequency was</span>
<span id="cb17-141"><a href="#cb17-141" aria-hidden="true" tabindex="-1"></a>increased. Means in the 1 min and 1 h time series are, thus, unlikely to</span>
<span id="cb17-142"><a href="#cb17-142" aria-hidden="true" tabindex="-1"></a>be affected significantly. Minima and maxima, and standard deviations</span>
<span id="cb17-143"><a href="#cb17-143" aria-hidden="true" tabindex="-1"></a>could, potentially be slightly affected.</span>
<span id="cb17-144"><a href="#cb17-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-145"><a href="#cb17-145" aria-hidden="true" tabindex="-1"></a>Soil data are acquired once every 12 min, and 1 h means of 5 values logged. The</span>
<span id="cb17-146"><a href="#cb17-146" aria-hidden="true" tabindex="-1"></a>values returned by the Vaisala WXT520 weather transmitter are acquired once</span>
<span id="cb17-147"><a href="#cb17-147" aria-hidden="true" tabindex="-1"></a>every 10 s for the WXT536. The averaging period in the WXT536 is also 10 s, 1</span>
<span id="cb17-148"><a href="#cb17-148" aria-hidden="true" tabindex="-1"></a>min and 1 h averages should not be affected by this change. Minima and maxima,</span>
<span id="cb17-149"><a href="#cb17-149" aria-hidden="true" tabindex="-1"></a>and standard deviations could, potentially be slightly affected.</span>
<span id="cb17-150"><a href="#cb17-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-151"><a href="#cb17-151" aria-hidden="true" tabindex="-1"></a>Data logging every 500 ms from data acquired every 50 ms is worthwhile only if</span>
<span id="cb17-152"><a href="#cb17-152" aria-hidden="true" tabindex="-1"></a>the variables being measured change this fast and the sensors have a suitably</span>
<span id="cb17-153"><a href="#cb17-153" aria-hidden="true" tabindex="-1"></a>short response time constant. The broad band light and UV sensors in use have a</span>
<span id="cb17-154"><a href="#cb17-154" aria-hidden="true" tabindex="-1"></a>time constant of 150 ms or better. The Apogee PAR sensor with analogue output</span>
<span id="cb17-155"><a href="#cb17-155" aria-hidden="true" tabindex="-1"></a>that we use has according to specifications a response time constant &lt; 1 ms, so</span>
<span id="cb17-156"><a href="#cb17-156" aria-hidden="true" tabindex="-1"></a>data from this sensor are additionally logged during one 5-min burst per hour at</span>
<span id="cb17-157"><a href="#cb17-157" aria-hidden="true" tabindex="-1"></a>50 ms.</span>
<span id="cb17-158"><a href="#cb17-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-159"><a href="#cb17-159" aria-hidden="true" tabindex="-1"></a>One consequence of these changes is the increased amount of data: for the 0.5 s</span>
<span id="cb17-160"><a href="#cb17-160" aria-hidden="true" tabindex="-1"></a>time step data raw-data files are approximately 1 GB per month. This makes</span>
<span id="cb17-161"><a href="#cb17-161" aria-hidden="true" tabindex="-1"></a>downloading data from the datalogger rather tedious.</span>
<span id="cb17-162"><a href="#cb17-162" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-163"><a href="#cb17-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-164"><a href="#cb17-164" aria-hidden="true" tabindex="-1"></a><span class="fu"># Logged acquired and summary values</span></span>
<span id="cb17-165"><a href="#cb17-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-166"><a href="#cb17-166" aria-hidden="true" tabindex="-1"></a>In this section I list the variables that are stored in the logger's</span>
<span id="cb17-167"><a href="#cb17-167" aria-hidden="true" tabindex="-1"></a>memory at different time intervals, plus the time and date-related</span>
<span id="cb17-168"><a href="#cb17-168" aria-hidden="true" tabindex="-1"></a>variables that are computed and adjusted to UTC when the data are</span>
<span id="cb17-169"><a href="#cb17-169" aria-hidden="true" tabindex="-1"></a>imported into R. The tables describe the variables as acquired and</span>
<span id="cb17-170"><a href="#cb17-170" aria-hidden="true" tabindex="-1"></a>logged starting on 2024-04-15.</span>
<span id="cb17-171"><a href="#cb17-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-172"><a href="#cb17-172" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data acquisition</span></span>
<span id="cb17-173"><a href="#cb17-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-174"><a href="#cb17-174" aria-hidden="true" tabindex="-1"></a>Fast measurements from analogue sensors are given priority over the </span>
<span id="cb17-175"><a href="#cb17-175" aria-hidden="true" tabindex="-1"></a>communication with sensors with digital serial interfaces using the</span>
<span id="cb17-176"><a href="#cb17-176" aria-hidden="true" tabindex="-1"></a>SDI12 protocol. The SDI12 protocol is used by the soil profile sensors and</span>
<span id="cb17-177"><a href="#cb17-177" aria-hidden="true" tabindex="-1"></a>the weather transmitter. Data from analogue sensors is acquired almost</span>
<span id="cb17-178"><a href="#cb17-178" aria-hidden="true" tabindex="-1"></a>synchronously, but not perfectly, as autoranging is used.</span>
<span id="cb17-179"><a href="#cb17-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-180"><a href="#cb17-180" aria-hidden="true" tabindex="-1"></a><span class="fu">## Quantities logged once per half second</span></span>
<span id="cb17-181"><a href="#cb17-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-182"><a href="#cb17-182" aria-hidden="true" tabindex="-1"></a>Logging of data once per 1 s tarted on 2024-04-15, thus the data listed</span>
<span id="cb17-183"><a href="#cb17-183" aria-hidden="true" tabindex="-1"></a>in @tbl-logged-second are not available before this date at this</span>
<span id="cb17-184"><a href="#cb17-184" aria-hidden="true" tabindex="-1"></a>frequency. They are nonetheless available as 1 min averages computed</span>
<span id="cb17-185"><a href="#cb17-185" aria-hidden="true" tabindex="-1"></a>from data acquired once every 5 s.</span>
<span id="cb17-186"><a href="#cb17-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-187"><a href="#cb17-187" aria-hidden="true" tabindex="-1"></a>| Quantity          | Summary    | Units     |</span>
<span id="cb17-188"><a href="#cb17-188" aria-hidden="true" tabindex="-1"></a>|:------------------|:-----------|:----------|</span>
<span id="cb17-189"><a href="#cb17-189" aria-hidden="true" tabindex="-1"></a>| "TIMESTAMP"       | mean of 10 |           |</span>
<span id="cb17-190"><a href="#cb17-190" aria-hidden="true" tabindex="-1"></a>| "PAR_Den"         | mean of 10 | µmol/s/m² |</span>
<span id="cb17-191"><a href="#cb17-191" aria-hidden="true" tabindex="-1"></a>| "PAR_BF_tot"      | mean of 10 | µmol/s/m² |</span>
<span id="cb17-192"><a href="#cb17-192" aria-hidden="true" tabindex="-1"></a>| "PAR_BF_diff"     | mean of 10 | µmol/s/m² |</span>
<span id="cb17-193"><a href="#cb17-193" aria-hidden="true" tabindex="-1"></a>| "Red_Den_cal"     | mean of 10 | µmol/s/m² |</span>
<span id="cb17-194"><a href="#cb17-194" aria-hidden="true" tabindex="-1"></a>| "Far_red_Den_cal" | mean of 10 | µmol/s/m² |</span>
<span id="cb17-195"><a href="#cb17-195" aria-hidden="true" tabindex="-1"></a>| "Blue_Den"        | mean of 10 | µmol/s/m² |</span>
<span id="cb17-196"><a href="#cb17-196" aria-hidden="true" tabindex="-1"></a>| "UVA_Den"         | mean of 10 | µmol/s/m² |</span>
<span id="cb17-197"><a href="#cb17-197" aria-hidden="true" tabindex="-1"></a>| "UVB_Den"         | mean of 10 | µmol/s/m² |</span>
<span id="cb17-198"><a href="#cb17-198" aria-hidden="true" tabindex="-1"></a>| "SurfTemp_grnd"   | mean of 10 | C         |</span>
<span id="cb17-199"><a href="#cb17-199" aria-hidden="true" tabindex="-1"></a>| "SurfTemp_veg"    | mean of 10 | C         |</span>
<span id="cb17-200"><a href="#cb17-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-201"><a href="#cb17-201" aria-hidden="true" tabindex="-1"></a>: Data logged once every 500 ms as means of 10 acquired values.</span>
<span id="cb17-202"><a href="#cb17-202" aria-hidden="true" tabindex="-1"></a>Column 'summary' shows how the data are summarised by the datalogger</span>
<span id="cb17-203"><a href="#cb17-203" aria-hidden="true" tabindex="-1"></a>before being stored, *sample* indicating that the most recently acquired</span>
<span id="cb17-204"><a href="#cb17-204" aria-hidden="true" tabindex="-1"></a>value is stored. The units are those obtained after off-line application</span>
<span id="cb17-205"><a href="#cb17-205" aria-hidden="true" tabindex="-1"></a>of calibration factors. {#tbl-logged-second}</span>
<span id="cb17-206"><a href="#cb17-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-207"><a href="#cb17-207" aria-hidden="true" tabindex="-1"></a><span class="fu">## Quantities logged once per minute</span></span>
<span id="cb17-208"><a href="#cb17-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-209"><a href="#cb17-209" aria-hidden="true" tabindex="-1"></a>The values currently logged are listed in @tbl-logged-minute. The</span>
<span id="cb17-210"><a href="#cb17-210" aria-hidden="true" tabindex="-1"></a>quantities logged once per minute are means of multiple data values</span>
<span id="cb17-211"><a href="#cb17-211" aria-hidden="true" tabindex="-1"></a>acquired by the data logger from the sensors. Until 2024-04-15 the data</span>
<span id="cb17-212"><a href="#cb17-212" aria-hidden="true" tabindex="-1"></a>acquired values acquired once every 5 s, from which the summaries listed</span>
<span id="cb17-213"><a href="#cb17-213" aria-hidden="true" tabindex="-1"></a>in @tbl-logged-minute are derived were not logged. Starting from</span>
<span id="cb17-214"><a href="#cb17-214" aria-hidden="true" tabindex="-1"></a>2024-04-15, data are being acquired more frequently, once every 1 s, and</span>
<span id="cb17-215"><a href="#cb17-215" aria-hidden="true" tabindex="-1"></a>thus the number of values used to compute 1 min means and other</span>
<span id="cb17-216"><a href="#cb17-216" aria-hidden="true" tabindex="-1"></a>summaries has increased from 12 to 60. In the case of the weather</span>
<span id="cb17-217"><a href="#cb17-217" aria-hidden="true" tabindex="-1"></a>variables acquired with the WXT weather transmitters, the data acquired</span>
<span id="cb17-218"><a href="#cb17-218" aria-hidden="true" tabindex="-1"></a>by the logger are summaries computed on-board of these "intelligent</span>
<span id="cb17-219"><a href="#cb17-219" aria-hidden="true" tabindex="-1"></a>sensors".</span>
<span id="cb17-220"><a href="#cb17-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-221"><a href="#cb17-221" aria-hidden="true" tabindex="-1"></a>| Quantity              | Summary              | Units     |</span>
<span id="cb17-222"><a href="#cb17-222" aria-hidden="true" tabindex="-1"></a>|:----------------------|:---------------------|:----------|</span>
<span id="cb17-223"><a href="#cb17-223" aria-hidden="true" tabindex="-1"></a>| "TIMESTAMP"           | sample               |           |</span>
<span id="cb17-224"><a href="#cb17-224" aria-hidden="true" tabindex="-1"></a>| "WindSpd_S_WVT"       | mean of 6 values     | m/s       |</span>
<span id="cb17-225"><a href="#cb17-225" aria-hidden="true" tabindex="-1"></a>| "WindDir_D1_WVT"      | mean of 6 values     | Deg       |</span>
<span id="cb17-226"><a href="#cb17-226" aria-hidden="true" tabindex="-1"></a>| "WindDir_SD1_WVT"     | mean of 6 values     | Deg       |</span>
<span id="cb17-227"><a href="#cb17-227" aria-hidden="true" tabindex="-1"></a>| "AirTemp_Avg"         | mean of 6 values     | C         |</span>
<span id="cb17-228"><a href="#cb17-228" aria-hidden="true" tabindex="-1"></a>| "AirTemp_Min"         | min of 6 values      | C         |</span>
<span id="cb17-229"><a href="#cb17-229" aria-hidden="true" tabindex="-1"></a>| "AirTemp_Max"         | max of 6 values      | C         |</span>
<span id="cb17-230"><a href="#cb17-230" aria-hidden="true" tabindex="-1"></a>| "RelHumidity"         | mean of 6 values     | \%        |</span>
<span id="cb17-231"><a href="#cb17-231" aria-hidden="true" tabindex="-1"></a>| "AirDewPoint"         | mean of 6 values     | C         |</span>
<span id="cb17-232"><a href="#cb17-232" aria-hidden="true" tabindex="-1"></a>| "AirPressure"         | mean of 6 values     | hPa       |</span>
<span id="cb17-233"><a href="#cb17-233" aria-hidden="true" tabindex="-1"></a>| "Ramount_Tot"         | sum                  | mm        |</span>
<span id="cb17-234"><a href="#cb17-234" aria-hidden="true" tabindex="-1"></a>| "Hamount_Tot"         | sum                  | hits/cm2  |</span>
<span id="cb17-235"><a href="#cb17-235" aria-hidden="true" tabindex="-1"></a>| "T107_C_Avg(1-4)"     | mean of 12/60 values | C         |</span>
<span id="cb17-236"><a href="#cb17-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-237"><a href="#cb17-237" aria-hidden="true" tabindex="-1"></a>: Data logged once per minute available before computation of derived</span>
<span id="cb17-238"><a href="#cb17-238" aria-hidden="true" tabindex="-1"></a>quantities. Column 'summary' shows how the data are summarised by the datalogger</span>
<span id="cb17-239"><a href="#cb17-239" aria-hidden="true" tabindex="-1"></a>before being stored. The units are those obtained after off-line application of</span>
<span id="cb17-240"><a href="#cb17-240" aria-hidden="true" tabindex="-1"></a>calibration factors. {#tbl-logged-minute}</span>
<span id="cb17-241"><a href="#cb17-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-242"><a href="#cb17-242" aria-hidden="true" tabindex="-1"></a><span class="fu">## Quantities logged once per hour</span></span>
<span id="cb17-243"><a href="#cb17-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-244"><a href="#cb17-244" aria-hidden="true" tabindex="-1"></a>The values currently logged are listed in @tbl-logged-hour,</span>
<span id="cb17-245"><a href="#cb17-245" aria-hidden="true" tabindex="-1"></a>respectively. These values are directly computed from the acquired data,</span>
<span id="cb17-246"><a href="#cb17-246" aria-hidden="true" tabindex="-1"></a>not from 1 min means.</span>
<span id="cb17-247"><a href="#cb17-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-248"><a href="#cb17-248" aria-hidden="true" tabindex="-1"></a>| Quantity               | Summary                               | Units     |</span>
<span id="cb17-249"><a href="#cb17-249" aria-hidden="true" tabindex="-1"></a>|:-----------------------|:--------------------------------------|:----------|</span>
<span id="cb17-250"><a href="#cb17-250" aria-hidden="true" tabindex="-1"></a>| "TIMESTAMP"            | sample                                |           |</span>
<span id="cb17-251"><a href="#cb17-251" aria-hidden="true" tabindex="-1"></a>| "VWC<span class="sc">\_\[</span>1-3<span class="sc">\]\_</span>Avg"    | mean of 5 values                      | m3/m-3    |</span>
<span id="cb17-252"><a href="#cb17-252" aria-hidden="true" tabindex="-1"></a>| "EC<span class="sc">\_\[</span>1-3<span class="sc">\]\_</span>Avg"     | mean of 5 values                      | dS/m      |</span>
<span id="cb17-253"><a href="#cb17-253" aria-hidden="true" tabindex="-1"></a>| "T<span class="sc">\_\[</span>1-3<span class="sc">\]\_</span>Avg"      | mean of 5 values                      | C         |</span>
<span id="cb17-254"><a href="#cb17-254" aria-hidden="true" tabindex="-1"></a>| "VWC_5cm<span class="sc">\_\[</span>1-3<span class="sc">\]</span>"     | mean of 5 values                      | m3/m-3    |</span>
<span id="cb17-255"><a href="#cb17-255" aria-hidden="true" tabindex="-1"></a>| "Ka_5cm<span class="sc">\_\[</span>1-3<span class="sc">\]</span>"      | mean of 5 values                      | 1..80     |</span>
<span id="cb17-256"><a href="#cb17-256" aria-hidden="true" tabindex="-1"></a>| "T_5cm<span class="sc">\_\[</span>1-3<span class="sc">\]</span>"       | mean of 5 values                      | C         |</span>
<span id="cb17-257"><a href="#cb17-257" aria-hidden="true" tabindex="-1"></a>| "BulkEC_5cm<span class="sc">\_\[</span>1-3<span class="sc">\]</span>"  | mean of 5 values                      | dS/m      |</span>
<span id="cb17-258"><a href="#cb17-258" aria-hidden="true" tabindex="-1"></a>| "VWC_10cm<span class="sc">\_\[</span>1-3<span class="sc">\]</span>"    | mean of 5 values                      | m3/m-3    |</span>
<span id="cb17-259"><a href="#cb17-259" aria-hidden="true" tabindex="-1"></a>| "Ka_10cm<span class="sc">\_\[</span>1-3<span class="sc">\]</span>"     | mean of 5 values                      | 1..80     |</span>
<span id="cb17-260"><a href="#cb17-260" aria-hidden="true" tabindex="-1"></a>| "T_10cm<span class="sc">\_\[</span>1-3<span class="sc">\]</span>"      | mean of 5 values                      | C         |</span>
<span id="cb17-261"><a href="#cb17-261" aria-hidden="true" tabindex="-1"></a>| "BulkEC_10cm<span class="sc">\_\[</span>1-3<span class="sc">\]</span>" | mean of 5 values                      | dS/m      |</span>
<span id="cb17-262"><a href="#cb17-262" aria-hidden="true" tabindex="-1"></a>| "VWC_20cm<span class="sc">\_\[</span>1-3<span class="sc">\]</span>"    | mean of 5 values                      | m3/m-3    |</span>
<span id="cb17-263"><a href="#cb17-263" aria-hidden="true" tabindex="-1"></a>| "Ka_20cm<span class="sc">\_\[</span>1-3<span class="sc">\]</span>"     | mean of 5 values                      | 1..80     |</span>
<span id="cb17-264"><a href="#cb17-264" aria-hidden="true" tabindex="-1"></a>| "T_20cm<span class="sc">\_\[</span>1-3<span class="sc">\]</span>"      | mean of 5 values                      | C         |</span>
<span id="cb17-265"><a href="#cb17-265" aria-hidden="true" tabindex="-1"></a>| "BulkEC_20cm<span class="sc">\_\[</span>1-3<span class="sc">\]</span>" | mean of 5 values                      | dS/m      |</span>
<span id="cb17-266"><a href="#cb17-266" aria-hidden="true" tabindex="-1"></a>| "VWC_30cm<span class="sc">\_\[</span>1-3<span class="sc">\]</span>"    | mean of 5 values                      | m3/m-3    |</span>
<span id="cb17-267"><a href="#cb17-267" aria-hidden="true" tabindex="-1"></a>| "Ka_30cm<span class="sc">\_\[</span>1-3<span class="sc">\]</span>"     | mean of 5 values                      | 1..80     |</span>
<span id="cb17-268"><a href="#cb17-268" aria-hidden="true" tabindex="-1"></a>| "T_30cm<span class="sc">\_\[</span>1-3<span class="sc">\]</span>"      | mean of 5 values                      | C         |</span>
<span id="cb17-269"><a href="#cb17-269" aria-hidden="true" tabindex="-1"></a>| "BulkEC_30cm<span class="sc">\_\[</span>1-3<span class="sc">\]</span>" | mean of 5 values                      | dS/m      |</span>
<span id="cb17-270"><a href="#cb17-270" aria-hidden="true" tabindex="-1"></a>| "VWC_40cm<span class="sc">\_\[</span>1-3<span class="sc">\]</span>"    | mean of 5 values                      | m3/m-3    |</span>
<span id="cb17-271"><a href="#cb17-271" aria-hidden="true" tabindex="-1"></a>| "Ka_40cm<span class="sc">\_\[</span>1-3<span class="sc">\]</span>"     | mean of 5 values                      | 1..80     |</span>
<span id="cb17-272"><a href="#cb17-272" aria-hidden="true" tabindex="-1"></a>| "T_40cm<span class="sc">\_\[</span>1-3<span class="sc">\]</span>"      | mean of 5 values                      | C         |</span>
<span id="cb17-273"><a href="#cb17-273" aria-hidden="true" tabindex="-1"></a>| "BulkEC_40cm<span class="sc">\_\[</span>1-3<span class="sc">\]</span>" | mean of 5 values                      | dS/m      |</span>
<span id="cb17-274"><a href="#cb17-274" aria-hidden="true" tabindex="-1"></a>| "VWC_50cm<span class="sc">\_\[</span>1-3<span class="sc">\]</span>"    | mean of 5 values                      | m3/m-3    |</span>
<span id="cb17-275"><a href="#cb17-275" aria-hidden="true" tabindex="-1"></a>| "Ka_50cm<span class="sc">\_\[</span>1-3<span class="sc">\]</span>"     | mean of 5 values                      | 1..80     |</span>
<span id="cb17-276"><a href="#cb17-276" aria-hidden="true" tabindex="-1"></a>| "T_50cm<span class="sc">\_\[</span>1-3<span class="sc">\]</span>"      | mean of 5 values                      | C         |</span>
<span id="cb17-277"><a href="#cb17-277" aria-hidden="true" tabindex="-1"></a>| "BulkEC_50cm<span class="sc">\_\[</span>1-3<span class="sc">\]</span>" | mean of 5 values                      | dS/m      |</span>
<span id="cb17-278"><a href="#cb17-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-279"><a href="#cb17-279" aria-hidden="true" tabindex="-1"></a>: Data logged once per hour available before computation of derived</span>
<span id="cb17-280"><a href="#cb17-280" aria-hidden="true" tabindex="-1"></a>quantities. Column 'summary' shows how the data are summarised by the</span>
<span id="cb17-281"><a href="#cb17-281" aria-hidden="true" tabindex="-1"></a>datalogger before being stored. When the number of values is indicated</span>
<span id="cb17-282"><a href="#cb17-282" aria-hidden="true" tabindex="-1"></a>as 720/3600, 720 is for data acquired before 2024-04-15 and 3600 for</span>
<span id="cb17-283"><a href="#cb17-283" aria-hidden="true" tabindex="-1"></a>more recent data. The units are those obtained after off-line</span>
<span id="cb17-284"><a href="#cb17-284" aria-hidden="true" tabindex="-1"></a>application of calibration factors. As for data logged at 1 min</span>
<span id="cb17-285"><a href="#cb17-285" aria-hidden="true" tabindex="-1"></a>intervals, the TIMESTAMP is converted to UTC time. Sun angles are not</span>
<span id="cb17-286"><a href="#cb17-286" aria-hidden="true" tabindex="-1"></a>computed. {#tbl-logged-hour}</span>
<span id="cb17-287"><a href="#cb17-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-288"><a href="#cb17-288" aria-hidden="true" tabindex="-1"></a><span class="fu"># Data processing in R</span></span>
<span id="cb17-289"><a href="#cb17-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-290"><a href="#cb17-290" aria-hidden="true" tabindex="-1"></a>The logged data are imported into R from files created by Campbell</span>
<span id="cb17-291"><a href="#cb17-291" aria-hidden="true" tabindex="-1"></a>Scientific's PC400 program. The files are read using function</span>
<span id="cb17-292"><a href="#cb17-292" aria-hidden="true" tabindex="-1"></a>read_csi_dat()<span class="sc">\`</span> from package 'photobiologyInOut'. The data now in data</span>
<span id="cb17-293"><a href="#cb17-293" aria-hidden="true" tabindex="-1"></a>frames are checked for duplicate rows, outlier values, and time shifts.</span>
<span id="cb17-294"><a href="#cb17-294" aria-hidden="true" tabindex="-1"></a>Problems are corrected when possible or data replaced by NAs when</span>
<span id="cb17-295"><a href="#cb17-295" aria-hidden="true" tabindex="-1"></a>recovery is not possible.</span>
<span id="cb17-296"><a href="#cb17-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-297"><a href="#cb17-297" aria-hidden="true" tabindex="-1"></a>In a separate step, R scripts are used to merge data in the different files</span>
<span id="cb17-298"><a href="#cb17-298" aria-hidden="true" tabindex="-1"></a>created during import into R. Validated calibrations and corrections are applied</span>
<span id="cb17-299"><a href="#cb17-299" aria-hidden="true" tabindex="-1"></a>obtaining a single data object with all data logged at a given frequency and new</span>
<span id="cb17-300"><a href="#cb17-300" aria-hidden="true" tabindex="-1"></a>summaries computed for variables logged at higher frequencies. The new scripts</span>
<span id="cb17-301"><a href="#cb17-301" aria-hidden="true" tabindex="-1"></a>do additional computations than those from version 1 including combining the</span>
<span id="cb17-302"><a href="#cb17-302" aria-hidden="true" tabindex="-1"></a>data from the three soil profile sensors into single median values. This is most</span>
<span id="cb17-303"><a href="#cb17-303" aria-hidden="true" tabindex="-1"></a>noticeable for data at 1 h and 1 d time steps. In the case of daily data we</span>
<span id="cb17-304"><a href="#cb17-304" aria-hidden="true" tabindex="-1"></a>use days at UTC rather than local time. As far as I am aware this is the same</span>
<span id="cb17-305"><a href="#cb17-305" aria-hidden="true" tabindex="-1"></a>approach used by the Finnish Meteorological Institute. The time for hourly</span>
<span id="cb17-306"><a href="#cb17-306" aria-hidden="true" tabindex="-1"></a>summaries follows UTC and matches approach used by the Finnish Meteorological </span>
<span id="cb17-307"><a href="#cb17-307" aria-hidden="true" tabindex="-1"></a>Institute, the reported time is that at the start/end of the hour for which</span>
<span id="cb17-308"><a href="#cb17-308" aria-hidden="true" tabindex="-1"></a>data are averaged.</span>
<span id="cb17-309"><a href="#cb17-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-310"><a href="#cb17-310" aria-hidden="true" tabindex="-1"></a>Additional quantities are calculated and added to the data set, including solar</span>
<span id="cb17-311"><a href="#cb17-311" aria-hidden="true" tabindex="-1"></a>time, sun elevation and sun azimuth based on geographic coordinates and UTC time</span>
<span id="cb17-312"><a href="#cb17-312" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">@tbl-r-script</span><span class="co">]</span>. The position of the sun and solar time are computed using Meuss</span>
<span id="cb17-313"><a href="#cb17-313" aria-hidden="true" tabindex="-1"></a>(1998) very accurate equations as implemented in R package 'photobiology'. The</span>
<span id="cb17-314"><a href="#cb17-314" aria-hidden="true" tabindex="-1"></a>coordinates of the weather station are for the locations of the mast, with</span>
<span id="cb17-315"><a href="#cb17-315" aria-hidden="true" tabindex="-1"></a>radiation sensors within 1.5 m of it, and soil sensors within 10 m. The accuracy</span>
<span id="cb17-316"><a href="#cb17-316" aria-hidden="true" tabindex="-1"></a>is that allowed by the image layer of the free version of Google Maps with high</span>
<span id="cb17-317"><a href="#cb17-317" aria-hidden="true" tabindex="-1"></a>resolution imagery.</span>
<span id="cb17-318"><a href="#cb17-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-319"><a href="#cb17-319" aria-hidden="true" tabindex="-1"></a>| Quantity           | Summary   | Units                     |</span>
<span id="cb17-320"><a href="#cb17-320" aria-hidden="true" tabindex="-1"></a>|:-------------------|:----------|:--------------------------|</span>
<span id="cb17-321"><a href="#cb17-321" aria-hidden="true" tabindex="-1"></a>| "time"             | sample    | yyyy-mm-dd hh:mm:ss UTC   |</span>
<span id="cb17-322"><a href="#cb17-322" aria-hidden="true" tabindex="-1"></a>| "day_of_year"      | sample    | numeric                   |</span>
<span id="cb17-323"><a href="#cb17-323" aria-hidden="true" tabindex="-1"></a>| "month_of_year"    | sample    | 1..12                     |</span>
<span id="cb17-324"><a href="#cb17-324" aria-hidden="true" tabindex="-1"></a>| "month_name"       | sample    | character                 |</span>
<span id="cb17-325"><a href="#cb17-325" aria-hidden="true" tabindex="-1"></a>| "calendar_year"    | sample    | numeric                   |</span>
<span id="cb17-326"><a href="#cb17-326" aria-hidden="true" tabindex="-1"></a>| "time_of_day"      | sample    | numeric                   |</span>
<span id="cb17-327"><a href="#cb17-327" aria-hidden="true" tabindex="-1"></a>| "solar_time"       | sample    | numeric                   |</span>
<span id="cb17-328"><a href="#cb17-328" aria-hidden="true" tabindex="-1"></a>| "sun_elevation"    | sample    | degrees                   |</span>
<span id="cb17-329"><a href="#cb17-329" aria-hidden="true" tabindex="-1"></a>| "sun_azimuth"      | sample    | degrees                   |</span>
<span id="cb17-330"><a href="#cb17-330" aria-hidden="true" tabindex="-1"></a>| "PAR_BF_diff_fr"   | sample    | /1                        |</span>
<span id="cb17-331"><a href="#cb17-331" aria-hidden="true" tabindex="-1"></a>| "PAR_diff_fr_rel"  | sample    | /1                        |</span>
<span id="cb17-332"><a href="#cb17-332" aria-hidden="true" tabindex="-1"></a>| "was_sunny"        | sample    | logical                   |</span>
<span id="cb17-333"><a href="#cb17-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-334"><a href="#cb17-334" aria-hidden="true" tabindex="-1"></a>: Some quantities are computed and added to the data set. Based on the</span>
<span id="cb17-335"><a href="#cb17-335" aria-hidden="true" tabindex="-1"></a>"TIMESTAMP" stored by the datalogger (and its difference from UTC time)</span>
<span id="cb17-336"><a href="#cb17-336" aria-hidden="true" tabindex="-1"></a>and the geographic coordinates of the station, the sun position and</span>
<span id="cb17-337"><a href="#cb17-337" aria-hidden="true" tabindex="-1"></a>solar time are computed and added to the data. "TIMESTAMP" is deleted</span>
<span id="cb17-338"><a href="#cb17-338" aria-hidden="true" tabindex="-1"></a>and replaced by "time" and the quantities in this table. {#tbl-r-script}</span>
<span id="cb17-339"><a href="#cb17-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-340"><a href="#cb17-340" aria-hidden="true" tabindex="-1"></a>Most calibrations are applied at this stage. (To facilitate monitoring a</span>
<span id="cb17-341"><a href="#cb17-341" aria-hidden="true" tabindex="-1"></a>calibration is used in the logger for most sensors, but small additional</span>
<span id="cb17-342"><a href="#cb17-342" aria-hidden="true" tabindex="-1"></a>adjustments based on calibrations done after the logger program was written are</span>
<span id="cb17-343"><a href="#cb17-343" aria-hidden="true" tabindex="-1"></a>applied off-line)</span>
<span id="cb17-344"><a href="#cb17-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-345"><a href="#cb17-345" aria-hidden="true" tabindex="-1"></a>Variable <span class="in">`was_sunny`</span> indicates occlusion or not of the solar disk,</span>
<span id="cb17-346"><a href="#cb17-346" aria-hidden="true" tabindex="-1"></a>estimated based on the deviation from the expected fraction of diffuse</span>
<span id="cb17-347"><a href="#cb17-347" aria-hidden="true" tabindex="-1"></a>PAR at the current sun elevation. The reference value is derived from</span>
<span id="cb17-348"><a href="#cb17-348" aria-hidden="true" tabindex="-1"></a>spectral irradiance simulations done with the TUV radiation transfer and</span>
<span id="cb17-349"><a href="#cb17-349" aria-hidden="true" tabindex="-1"></a>atmosphere photochemistry model TUV. The variable is set to <span class="in">`NA`</span> when</span>
<span id="cb17-350"><a href="#cb17-350" aria-hidden="true" tabindex="-1"></a>the sun is below the horizon or diffuse PAR irradiance is less than 5</span>
<span id="cb17-351"><a href="#cb17-351" aria-hidden="true" tabindex="-1"></a>$\mathrm{\mu mol\,m^{-2}\,s^{-1}}$.</span>
<span id="cb17-352"><a href="#cb17-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-353"><a href="#cb17-353" aria-hidden="true" tabindex="-1"></a>The irradiances of UV-A1 and UV-A2 are derived from the measured UV-A,</span>
<span id="cb17-354"><a href="#cb17-354" aria-hidden="true" tabindex="-1"></a>UV-B and blue irradiances, based on calibrations on-site against a</span>
<span id="cb17-355"><a href="#cb17-355" aria-hidden="true" tabindex="-1"></a>spectrometer. The UV-A irradiance measurements are also corrected for</span>
<span id="cb17-356"><a href="#cb17-356" aria-hidden="true" tabindex="-1"></a>the temperature coefficient of the sensor as published [Langer</span>
<span id="cb17-357"><a href="#cb17-357" aria-hidden="true" tabindex="-1"></a>2020](https://download.sglux.de/publications/sglux_SiC_Temperature_Coefficient.pdf),</span>
<span id="cb17-358"><a href="#cb17-358" aria-hidden="true" tabindex="-1"></a>taking into account spectral dependence of the temperature and radiation</span>
<span id="cb17-359"><a href="#cb17-359" aria-hidden="true" tabindex="-1"></a>responses and the shape of the solar spectrum.</span>
<span id="cb17-360"><a href="#cb17-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-361"><a href="#cb17-361" aria-hidden="true" tabindex="-1"></a>A new UV-A1 sensor will put in service during 2024.</span>
<span id="cb17-362"><a href="#cb17-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-363"><a href="#cb17-363" aria-hidden="true" tabindex="-1"></a><span class="fu"># Information about the published data</span></span>
<span id="cb17-364"><a href="#cb17-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-365"><a href="#cb17-365" aria-hidden="true" tabindex="-1"></a>In the examples below, we use R to read the data from <span class="in">`.rda`</span> files, but</span>
<span id="cb17-366"><a href="#cb17-366" aria-hidden="true" tabindex="-1"></a>the same data are also available as comma separated values (CSV) in Gnu</span>
<span id="cb17-367"><a href="#cb17-367" aria-hidden="true" tabindex="-1"></a>Zip (gzip) compressed files.</span>
<span id="cb17-368"><a href="#cb17-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-371"><a href="#cb17-371" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-372"><a href="#cb17-372" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"F:/aphalo/research-data/data-weather/RFR-Viikki-field/data-rda/second_2024_latest.tb.rda"</span>)</span>
<span id="cb17-373"><a href="#cb17-373" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">comment</span>(second_2024_latest.tb))</span>
<span id="cb17-374"><a href="#cb17-374" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-375"><a href="#cb17-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-376"><a href="#cb17-376" aria-hidden="true" tabindex="-1"></a>**The data set at 1 second interval** has</span>
<span id="cb17-377"><a href="#cb17-377" aria-hidden="true" tabindex="-1"></a><span class="in">`r nrow(second_2024_latest.tb)`</span> rows and <span class="in">`r ncol(second_2024_latest.tb)`</span></span>
<span id="cb17-378"><a href="#cb17-378" aria-hidden="true" tabindex="-1"></a>variables.</span>
<span id="cb17-379"><a href="#cb17-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-380"><a href="#cb17-380" aria-hidden="true" tabindex="-1"></a>The variables are</span>
<span id="cb17-381"><a href="#cb17-381" aria-hidden="true" tabindex="-1"></a><span class="in">`r paste(colnames(second_2024_latest.tb), collapse = ", ")`</span>.</span>
<span id="cb17-382"><a href="#cb17-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-385"><a href="#cb17-385" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-386"><a href="#cb17-386" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"F:/aphalo/research-data/data-weather/RFR-Viikki-field/data-rda/minute_2024_latest.tb.rda"</span>)</span>
<span id="cb17-387"><a href="#cb17-387" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">comment</span>(minute_2024_latest.tb))</span>
<span id="cb17-388"><a href="#cb17-388" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-389"><a href="#cb17-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-390"><a href="#cb17-390" aria-hidden="true" tabindex="-1"></a>**The data set at 1 min interval** has <span class="in">`r nrow(minute_2024_latest.tb)`</span></span>
<span id="cb17-391"><a href="#cb17-391" aria-hidden="true" tabindex="-1"></a>rows and <span class="in">`r ncol(minute_2024_latest.tb)`</span> variables.</span>
<span id="cb17-392"><a href="#cb17-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-393"><a href="#cb17-393" aria-hidden="true" tabindex="-1"></a>The variables are</span>
<span id="cb17-394"><a href="#cb17-394" aria-hidden="true" tabindex="-1"></a><span class="in">`r paste(colnames(minute_2024_latest.tb), collapse = ", ")`</span>.</span>
<span id="cb17-395"><a href="#cb17-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-398"><a href="#cb17-398" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-399"><a href="#cb17-399" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"F:/aphalo/research-data/data-weather/RFR-Viikki-field/data-rda/hour_2024_latest.tb.rda"</span>)</span>
<span id="cb17-400"><a href="#cb17-400" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">comment</span>(hour_2024_latest.tb))</span>
<span id="cb17-401"><a href="#cb17-401" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-402"><a href="#cb17-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-403"><a href="#cb17-403" aria-hidden="true" tabindex="-1"></a>**The data set at 1 h interval** has</span>
<span id="cb17-404"><a href="#cb17-404" aria-hidden="true" tabindex="-1"></a><span class="in">`r nrow(hour_2024_latest.tb)`</span> rows and</span>
<span id="cb17-405"><a href="#cb17-405" aria-hidden="true" tabindex="-1"></a><span class="in">`r ncol(hour_2024_latest.tb)`</span> variables. The variables are</span>
<span id="cb17-406"><a href="#cb17-406" aria-hidden="true" tabindex="-1"></a><span class="in">`r paste(colnames(hour_2024_latest.tb), collapse = ", ")`</span>.</span>
<span id="cb17-407"><a href="#cb17-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-410"><a href="#cb17-410" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-411"><a href="#cb17-411" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"F:/aphalo/research-data/data-weather/RFR-Viikki-field/data-rda/day_2024_latest.tb.rda"</span>)</span>
<span id="cb17-412"><a href="#cb17-412" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">comment</span>(hour_2024_latest.tb))</span>
<span id="cb17-413"><a href="#cb17-413" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-414"><a href="#cb17-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-415"><a href="#cb17-415" aria-hidden="true" tabindex="-1"></a>**The data set at 1 d interval** has</span>
<span id="cb17-416"><a href="#cb17-416" aria-hidden="true" tabindex="-1"></a><span class="in">`r nrow(day_2024_latest.tb)`</span> rows and</span>
<span id="cb17-417"><a href="#cb17-417" aria-hidden="true" tabindex="-1"></a><span class="in">`r ncol(day_2024_latest.tb)`</span> variables. The variables are</span>
<span id="cb17-418"><a href="#cb17-418" aria-hidden="true" tabindex="-1"></a><span class="in">`r paste(colnames(day_2024_latest.tb), collapse = ", ")`</span>.</span>
<span id="cb17-419"><a href="#cb17-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-420"><a href="#cb17-420" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb17-421"><a href="#cb17-421" aria-hidden="true" tabindex="-1"></a>A detailed data dictionary will be added soon to the data objects</span>
<span id="cb17-422"><a href="#cb17-422" aria-hidden="true" tabindex="-1"></a>themselves. Data are in SI units and in most cases without scale</span>
<span id="cb17-423"><a href="#cb17-423" aria-hidden="true" tabindex="-1"></a>factors. The units described for the logged data in the tables above are</span>
<span id="cb17-424"><a href="#cb17-424" aria-hidden="true" tabindex="-1"></a>not modified except for sensors for which mV signals are logged.</span>
<span id="cb17-425"><a href="#cb17-425" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-426"><a href="#cb17-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-427"><a href="#cb17-427" aria-hidden="true" tabindex="-1"></a><span class="fu"># Example plots</span></span>
<span id="cb17-428"><a href="#cb17-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-429"><a href="#cb17-429" aria-hidden="true" tabindex="-1"></a>Using data saved at 1 min interval we can compute empirical desity</span>
<span id="cb17-430"><a href="#cb17-430" aria-hidden="true" tabindex="-1"></a>distributions, showing how frequently different values have been</span>
<span id="cb17-431"><a href="#cb17-431" aria-hidden="true" tabindex="-1"></a>observed.</span>
<span id="cb17-432"><a href="#cb17-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-433"><a href="#cb17-433" aria-hidden="true" tabindex="-1"></a><span class="fu">## PAR photon irradiance</span></span>
<span id="cb17-434"><a href="#cb17-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-435"><a href="#cb17-435" aria-hidden="true" tabindex="-1"></a>Photosynthetically active radiation photon irradiance at Viikki,</span>
<span id="cb17-436"><a href="#cb17-436" aria-hidden="true" tabindex="-1"></a>Helsinki, presented as fitted empirical density functions for each month</span>
<span id="cb17-437"><a href="#cb17-437" aria-hidden="true" tabindex="-1"></a>of the year <span class="co">[</span><span class="ot">@fig-PAR-month-sec, @fig-PAR-month-min</span><span class="co">]</span>. During winter-time some snow from time to</span>
<span id="cb17-438"><a href="#cb17-438" aria-hidden="true" tabindex="-1"></a>time accumulated on the sensor may have distorted the distribution to</span>
<span id="cb17-439"><a href="#cb17-439" aria-hidden="true" tabindex="-1"></a>some extent. (Each curve in the plot can be thought as equivalent to a</span>
<span id="cb17-440"><a href="#cb17-440" aria-hidden="true" tabindex="-1"></a>smoothed-out histogram, scaled to an area of one.)</span>
<span id="cb17-441"><a href="#cb17-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-444"><a href="#cb17-444" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-445"><a href="#cb17-445" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-PAR-month-sec</span></span>
<span id="cb17-446"><a href="#cb17-446" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Empirical density of photosynthetically active radiation (PAR) irradiances by month of the year. The density curves have been fitted to 0.5 s averages computed from data acquired once every 50 ms.</span></span>
<span id="cb17-447"><a href="#cb17-447" aria-hidden="true" tabindex="-1"></a>second_2024_latest.tb <span class="sc">%&gt;%</span></span>
<span id="cb17-448"><a href="#cb17-448" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sun_elevation <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> PAR_umol <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-449"><a href="#cb17-449" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(month_name, PAR_umol, calendar_year) <span class="sc">%&gt;%</span></span>
<span id="cb17-450"><a href="#cb17-450" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-451"><a href="#cb17-451" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PAR_umol, <span class="at">y =</span> month_name)) <span class="sc">+</span></span>
<span id="cb17-452"><a href="#cb17-452" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_panel_counts</span>(<span class="at">label.y =</span> <span class="st">"top"</span>, <span class="at">label.x =</span> <span class="st">"right"</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb17-453"><a href="#cb17-453" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="fl">2.5</span>, <span class="at">fill =</span> <span class="st">"yellow"</span>, <span class="at">alpha =</span> <span class="fl">0.33</span>) <span class="sc">+</span></span>
<span id="cb17-454"><a href="#cb17-454" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="fl">0.03</span>, <span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">10</span>, <span class="dv">30</span>, <span class="dv">100</span>, <span class="dv">300</span>, <span class="dv">1000</span>, <span class="dv">3000</span>), </span>
<span id="cb17-455"><a href="#cb17-455" aria-hidden="true" tabindex="-1"></a>                <span class="at">minor_breaks =</span> <span class="cn">NULL</span>,</span>
<span id="cb17-456"><a href="#cb17-456" aria-hidden="true" tabindex="-1"></a>                <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">format_format</span>(<span class="at">digits =</span> <span class="dv">3</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>)) <span class="sc">+</span></span>
<span id="cb17-457"><a href="#cb17-457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">drop=</span><span class="cn">FALSE</span>, <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.2</span>))) <span class="sc">+</span></span>
<span id="cb17-458"><a href="#cb17-458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">3000</span>)) <span class="sc">+</span></span>
<span id="cb17-459"><a href="#cb17-459" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(PAR<span class="sc">~</span><span class="er">~</span>photon<span class="sc">~</span><span class="er">~</span>irradiance<span class="sc">~</span><span class="er">~</span>(mu<span class="sc">*</span>mol<span class="sc">~</span>m<span class="sc">^</span>{<span class="sc">-</span><span class="dv">2</span>}<span class="sc">~</span>s<span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>})), <span class="at">y =</span> <span class="st">"Month of the year"</span>) <span class="ot">-&gt;</span> par_month_rigdes.fig</span>
<span id="cb17-460"><a href="#cb17-460" aria-hidden="true" tabindex="-1"></a>par_month_rigdes.fig</span>
<span id="cb17-461"><a href="#cb17-461" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-462"><a href="#cb17-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-465"><a href="#cb17-465" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-466"><a href="#cb17-466" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-PAR-month-min</span></span>
<span id="cb17-467"><a href="#cb17-467" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Empirical density of photosynthetically active radiation (PAR) irradiances by month of the year. The density curves have been fitted to 1 min averages computed from data acquired once every 50 ms.</span></span>
<span id="cb17-468"><a href="#cb17-468" aria-hidden="true" tabindex="-1"></a>minute_2024_latest.tb <span class="sc">%&gt;%</span></span>
<span id="cb17-469"><a href="#cb17-469" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sun_elevation <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> PAR_umol <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-470"><a href="#cb17-470" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(month_name, PAR_umol, calendar_year) <span class="sc">%&gt;%</span></span>
<span id="cb17-471"><a href="#cb17-471" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-472"><a href="#cb17-472" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PAR_umol, <span class="at">y =</span> month_name)) <span class="sc">+</span></span>
<span id="cb17-473"><a href="#cb17-473" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_panel_counts</span>(<span class="at">label.y =</span> <span class="st">"top"</span>, <span class="at">label.x =</span> <span class="st">"right"</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb17-474"><a href="#cb17-474" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="fl">2.5</span>, <span class="at">fill =</span> <span class="st">"yellow"</span>, <span class="at">alpha =</span> <span class="fl">0.33</span>) <span class="sc">+</span></span>
<span id="cb17-475"><a href="#cb17-475" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="fl">0.03</span>, <span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">10</span>, <span class="dv">30</span>, <span class="dv">100</span>, <span class="dv">300</span>, <span class="dv">1000</span>, <span class="dv">3000</span>), </span>
<span id="cb17-476"><a href="#cb17-476" aria-hidden="true" tabindex="-1"></a>                <span class="at">minor_breaks =</span> <span class="cn">NULL</span>,</span>
<span id="cb17-477"><a href="#cb17-477" aria-hidden="true" tabindex="-1"></a>                <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">format_format</span>(<span class="at">digits =</span> <span class="dv">3</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>)) <span class="sc">+</span></span>
<span id="cb17-478"><a href="#cb17-478" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">drop=</span><span class="cn">FALSE</span>, <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.2</span>))) <span class="sc">+</span></span>
<span id="cb17-479"><a href="#cb17-479" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">3000</span>)) <span class="sc">+</span></span>
<span id="cb17-480"><a href="#cb17-480" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(PAR<span class="sc">~</span><span class="er">~</span>photon<span class="sc">~</span><span class="er">~</span>irradiance<span class="sc">~</span><span class="er">~</span>(mu<span class="sc">*</span>mol<span class="sc">~</span>m<span class="sc">^</span>{<span class="sc">-</span><span class="dv">2</span>}<span class="sc">~</span>s<span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>})), <span class="at">y =</span> <span class="st">"Month of the year"</span>) <span class="ot">-&gt;</span> par_month_rigdes.fig</span>
<span id="cb17-481"><a href="#cb17-481" aria-hidden="true" tabindex="-1"></a>par_month_rigdes.fig</span>
<span id="cb17-482"><a href="#cb17-482" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-483"><a href="#cb17-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-484"><a href="#cb17-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-487"><a href="#cb17-487" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-488"><a href="#cb17-488" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-PAR-month-hour</span></span>
<span id="cb17-489"><a href="#cb17-489" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Empirical density of photosynthetically active radiation (PAR) irradiances by month of the year. The density curves have been fitted to 1 h averages computed from data acquired once every 50 ms.</span></span>
<span id="cb17-490"><a href="#cb17-490" aria-hidden="true" tabindex="-1"></a>hour_2024_latest.tb <span class="sc">%&gt;%</span></span>
<span id="cb17-491"><a href="#cb17-491" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sun_elevation <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> PAR_umol_mean <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-492"><a href="#cb17-492" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(month_name, PAR_umol_mean, calendar_year) <span class="sc">%&gt;%</span></span>
<span id="cb17-493"><a href="#cb17-493" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-494"><a href="#cb17-494" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PAR_umol_mean, <span class="at">y =</span> month_name)) <span class="sc">+</span></span>
<span id="cb17-495"><a href="#cb17-495" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_panel_counts</span>(<span class="at">label.y =</span> <span class="st">"top"</span>, <span class="at">label.x =</span> <span class="st">"right"</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb17-496"><a href="#cb17-496" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="fl">2.5</span>, <span class="at">fill =</span> <span class="st">"yellow"</span>, <span class="at">alpha =</span> <span class="fl">0.33</span>) <span class="sc">+</span></span>
<span id="cb17-497"><a href="#cb17-497" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="fl">0.03</span>, <span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">10</span>, <span class="dv">30</span>, <span class="dv">100</span>, <span class="dv">300</span>, <span class="dv">1000</span>, <span class="dv">3000</span>), </span>
<span id="cb17-498"><a href="#cb17-498" aria-hidden="true" tabindex="-1"></a>                <span class="at">minor_breaks =</span> <span class="cn">NULL</span>,</span>
<span id="cb17-499"><a href="#cb17-499" aria-hidden="true" tabindex="-1"></a>                <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">format_format</span>(<span class="at">digits =</span> <span class="dv">3</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>)) <span class="sc">+</span></span>
<span id="cb17-500"><a href="#cb17-500" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">drop=</span><span class="cn">FALSE</span>, <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.2</span>))) <span class="sc">+</span></span>
<span id="cb17-501"><a href="#cb17-501" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">3000</span>)) <span class="sc">+</span></span>
<span id="cb17-502"><a href="#cb17-502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(PAR<span class="sc">~</span><span class="er">~</span>photon<span class="sc">~</span><span class="er">~</span>irradiance<span class="sc">~</span><span class="er">~</span>(mu<span class="sc">*</span>mol<span class="sc">~</span>m<span class="sc">^</span>{<span class="sc">-</span><span class="dv">2</span>}<span class="sc">~</span>s<span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>})), <span class="at">y =</span> <span class="st">"Month of the year"</span>) <span class="ot">-&gt;</span> par_month_rigdes.fig</span>
<span id="cb17-503"><a href="#cb17-503" aria-hidden="true" tabindex="-1"></a>par_month_rigdes.fig</span>
<span id="cb17-504"><a href="#cb17-504" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-505"><a href="#cb17-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-506"><a href="#cb17-506" aria-hidden="true" tabindex="-1"></a><span class="fu">## Soil temperature profile</span></span>
<span id="cb17-507"><a href="#cb17-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-510"><a href="#cb17-510" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-511"><a href="#cb17-511" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"F:/aphalo/research-data/data-weather/RFR-Viikki-field/data-rda/hour_2024_latest.tb.rda"</span>)</span>
<span id="cb17-512"><a href="#cb17-512" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-513"><a href="#cb17-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-516"><a href="#cb17-516" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-517"><a href="#cb17-517" aria-hidden="true" tabindex="-1"></a>hour_2024_latest.tb <span class="sc">%&gt;%</span></span>
<span id="cb17-518"><a href="#cb17-518" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(time, month_of_year, day_of_year, calendar_year, <span class="fu">starts_with</span>(<span class="st">"T_"</span>) <span class="sc">&amp;</span> <span class="fu">ends_with</span>(<span class="st">"cm"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-519"><a href="#cb17-519" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">starts_with</span>(<span class="st">"T_"</span>), <span class="at">names_to =</span> <span class="st">"layer"</span>, <span class="at">values_to =</span> <span class="st">"soil_t"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-520"><a href="#cb17-520" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">depth =</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"T_|cm"</span>, <span class="st">""</span>, layer))) <span class="ot">-&gt;</span> soil_temperature.tb</span>
<span id="cb17-521"><a href="#cb17-521" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-522"><a href="#cb17-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-523"><a href="#cb17-523" aria-hidden="true" tabindex="-1"></a>In @fig-soil-temp-depth the soil temperature depth profile is shown. It</span>
<span id="cb17-524"><a href="#cb17-524" aria-hidden="true" tabindex="-1"></a>is summarised using quantile regression for the 5%, 50% and 95%</span>
<span id="cb17-525"><a href="#cb17-525" aria-hidden="true" tabindex="-1"></a>percentiles. This highlights the range of variation at different depths</span>
<span id="cb17-526"><a href="#cb17-526" aria-hidden="true" tabindex="-1"></a>on different months of the year. The data values, not plotted, are</span>
<span id="cb17-527"><a href="#cb17-527" aria-hidden="true" tabindex="-1"></a>medians from three sensors, logged once every 1 h..</span>
<span id="cb17-528"><a href="#cb17-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-529"><a href="#cb17-529" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE, message=FALSE}</span></span>
<span id="cb17-530"><a href="#cb17-530" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-soil-temp-depth</span></span>
<span id="cb17-531"><a href="#cb17-531" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: Soil-temperature depth profile for each month of the year.</span></span>
<span id="cb17-532"><a href="#cb17-532" aria-hidden="true" tabindex="-1"></a><span class="in">soil_temperature.tb %&gt;%</span></span>
<span id="cb17-533"><a href="#cb17-533" aria-hidden="true" tabindex="-1"></a><span class="in">  na.omit() %&gt;%</span></span>
<span id="cb17-534"><a href="#cb17-534" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(depth, soil_t)) +</span></span>
<span id="cb17-535"><a href="#cb17-535" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_quant_band(formula = y ~ poly(x, 5, raw = TRUE), quantiles = c(0.05, 0.5, 0.95)) +</span></span>
<span id="cb17-536"><a href="#cb17-536" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(y = "Soil temperature (C)", x = "Depth (cm)") +</span></span>
<span id="cb17-537"><a href="#cb17-537" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(~factor(month.name[month_of_year], levels = month.name[unique(month_of_year)])) +</span></span>
<span id="cb17-538"><a href="#cb17-538" aria-hidden="true" tabindex="-1"></a><span class="in">  xlim(50, 0) +</span></span>
<span id="cb17-539"><a href="#cb17-539" aria-hidden="true" tabindex="-1"></a><span class="in">#  scale_x_continuous(trans = "reverse") +</span></span>
<span id="cb17-540"><a href="#cb17-540" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_flip() -&gt; soil_t.fig</span></span>
<span id="cb17-541"><a href="#cb17-541" aria-hidden="true" tabindex="-1"></a><span class="in">soil_t.fig</span></span>
<span id="cb17-542"><a href="#cb17-542" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-543"><a href="#cb17-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-544"><a href="#cb17-544" aria-hidden="true" tabindex="-1"></a>In @fig-soil-temp-time-course we show hourly temperatures at different</span>
<span id="cb17-545"><a href="#cb17-545" aria-hidden="true" tabindex="-1"></a>depths over a few days, showing the daily warming and cooling of the</span>
<span id="cb17-546"><a href="#cb17-546" aria-hidden="true" tabindex="-1"></a>mostly bare soil. The data values shown are medians from three sensors,</span>
<span id="cb17-547"><a href="#cb17-547" aria-hidden="true" tabindex="-1"></a>acquired once every 1 h.</span>
<span id="cb17-548"><a href="#cb17-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-549"><a href="#cb17-549" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE, message=FALSE}</span></span>
<span id="cb17-550"><a href="#cb17-550" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-soil-temp-time-course</span></span>
<span id="cb17-551"><a href="#cb17-551" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: Soil-temperature time course at nine different depths during nine consecutive days in the Summer of year 2020. Data logged once per every 1 h.</span></span>
<span id="cb17-552"><a href="#cb17-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-553"><a href="#cb17-553" aria-hidden="true" tabindex="-1"></a><span class="in">soil_temperature.tb %&gt;%</span></span>
<span id="cb17-554"><a href="#cb17-554" aria-hidden="true" tabindex="-1"></a><span class="in">#  filter(day_of_year &gt; 190 &amp; day_of_year &lt; 200 &amp; calendar_year == 2024) %&gt;%</span></span>
<span id="cb17-555"><a href="#cb17-555" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(time, soil_t, colour = factor(depth))) +</span></span>
<span id="cb17-556"><a href="#cb17-556" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line() +</span></span>
<span id="cb17-557"><a href="#cb17-557" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(y = "Soil temperature (C)", x = "Time",</span></span>
<span id="cb17-558"><a href="#cb17-558" aria-hidden="true" tabindex="-1"></a><span class="in">       colour = "Depth (cm)")  -&gt; soil_t_daily.fig</span></span>
<span id="cb17-559"><a href="#cb17-559" aria-hidden="true" tabindex="-1"></a><span class="in">soil_t_daily.fig</span></span>
<span id="cb17-560"><a href="#cb17-560" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
<li class="nav-item">
    <a class="nav-link" href="https://orcid.org/0000-0003-3385-972X">
<p>P. J. Aphalo @ ORCID</p>
</a>
  </li>  
</ul>
</div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
<li class="nav-item">
 Viikki Campus Weather Station
  </li>  
</ul>
</div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item">
    <a class="nav-link" href="./about.html">
<p>© 2015-2024 Pedro J. Aphalo</p>
</a>
  </li>  
</ul>
</div>
  </div>
</footer>


</body></html>